<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <title>Photon propagator</title>
  <meta name="viewport" content="width=device-width">
  <link rel="stylesheet" href="../style.css">
  <link rel="icon" href="../favicon.svg" type="image/svg+xml">
 </head>
 <body>
</pre>
<h1 id="PhotonPropagator">Photon propagator</h1>
<p>In this example we will calculate symbolically and evaluate
numerically a photon propagator. The physical model is QCD
with generic color group (symbolic <code>Nc</code>, <code>Ca</code>, <code>Cf</code>, etc),
<code>Nf</code> light quarks, and <code>Nft</code> heavy quarks of squared mass
<code>mt2</code>.</p>
<p>To start off, for interactive development it is convenient
to reduce the width of Mathematica formatted output to 65
characters, and force it to clear the history (the <code>Out[]</code>
variables) so that old expressions would not linger on in
the memory.</p>
<pre><a class="tnb" href="https://reference.wolfram.com/language/ref/SetOptions.html" rel="nofollow">SetOptions</a>[<a class="tnb" href="https://reference.wolfram.com/language/ref/$Output.html" rel="nofollow">$Output</a>, <a class="tnb" href="https://reference.wolfram.com/language/ref/PageWidth.html" rel="nofollow">PageWidth</a> -&gt; <span class="tl">65</span>];
<a class="tnb" href="https://reference.wolfram.com/language/ref/$HistoryLength.html" rel="nofollow">$HistoryLength</a> = <span class="tl">2</span>;</pre>
<p>Load <em>alibrary</em> and the <a href="../amodel-qcd.html#QcdFeynmanRules">QCD Feynman rules</a> from <code>amodel-qcd.m</code>.</p>
<pre><a class="tnb" href="https://reference.wolfram.com/language/ref/Get.html" rel="nofollow">Get</a>[<span class="ts">"alibrary.m"</span>];
<a class="tnb" href="https://reference.wolfram.com/language/ref/Get.html" rel="nofollow">Get</a>[<span class="tnv">$Apath</span> &lt;&gt; <span class="ts">"/amodel-qcd.m"</span>];</pre>
<p>We shall calculate the corrections of order <img alt="\alpha_s^\text{NLOOPS}" style="vertical-align:-4.968942260742187pt" src="data:image/svg+xml,%3Csvg%20width%3D%2246.148pt%22%20height%3D%2217.068pt%22%20version%3D%221.1%22%20viewBox%3D%220%200%2046.148%2017.068%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%3E%3Cdefs%3E%3Csymbol%20id%3D%22g%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m6.3281-4.875c-0.25-1-0.82812-1.7656-1.875-1.7656-1.6719%200-3.125%201.3594-3.4844%203.2656-0.0625%200.3125-0.09375%200.64062-0.09375%200.9375%200%201.5469%200.84375%202.5625%202.2188%202.5625%201.0312%200%201.8438-0.53125%202.5312-1.375%200.09375%200.78125%200.32812%201.375%200.92188%201.375%200.5625%200%201.3906-0.79688%202.0312-1.4219l-0.32812-0.39062c-0.28125%200.25-0.71875%200.6875-0.82812%200.6875-0.75%200-0.92188-0.73438-0.9375-1.5469%200.65625-1.2188%201.1875-2.7188%201.6719-4.0938h-1.1875c-0.20312%200.5625-0.42188%201.1719-0.64062%201.7656zm-0.71875%201.7344c-0.6875%201.5312-1.4688%202.7344-2.3281%202.7344-0.82812%200-1.2969-0.6875-1.2969-1.7656%200-0.29688%200.046875-0.625%200.10938-0.96875%200.34375-1.7812%201.2188-2.9531%202.25-2.9531%201.0938%200%201.2812%201.1562%201.2812%202.3594%200%200.20312-0.015625%200.40625-0.015625%200.59375z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22f%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m0.28125%200h2.0156v-0.39062l-0.57812-0.078125-0.17188-0.1875v-4.7812l3.6406%205.4375h0.64062v-5.7812l0.17188-0.17188%200.5625-0.078125v-0.39062h-2v0.39062l0.57812%200.078125%200.17188%200.17188v4.5l-3.2656-4.8906v-0.25h-1.7969v0.39062l0.60938%200.0625%200.17188%200.125v5.1875l-0.17188%200.1875-0.57812%200.078125z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22e%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m0.26562%200h4.5781v-1.7344h-0.5l-0.17188%201.1406-0.125%200.15625h-2.1562v-5.4062l0.15625-0.125%200.54688-0.0625v-0.39062h-2.3281v0.39062l0.59375%200.0625%200.15625%200.125v5.2656l-0.15625%200.14062-0.59375%200.046875z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22a%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m3.5-6.5781c-0.82812%200-1.5469%200.28125-2.1094%200.84375-0.64062%200.625-0.98438%201.4844-0.98438%202.5156%200%201.0469%200.34375%201.9219%200.98438%202.5469%200.5625%200.53125%201.2969%200.82812%202.1094%200.82812%201.1094%200%202.0625-0.5625%202.5938-1.4688%200.32812-0.5625%200.5-1.1875%200.5-1.9062%200-1.0312-0.34375-1.8906-0.98438-2.5156-0.57812-0.5625-1.2812-0.84375-2.1094-0.84375zm0%200.51562c1.2344%200%202.0781%201.0781%202.0781%202.8438%200%201.7812-0.84375%202.8594-2.0781%202.8594-1.25%200-2.0938-1.0781-2.0938-2.8594%200-1.7969%200.84375-2.8438%202.0938-2.8438z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22d%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m0.3125%200h2.4062v-0.39062l-0.67188-0.046875-0.15625-0.14062v-1.875c0.29688%200.03125%200.53125%200.046875%200.70312%200.046875%201.5469%200%202.4844-0.82812%202.4844-2.0625%200-1.4531-0.82812-1.9531-2.6562-1.9531h-2.1875v0.39062l0.625%200.0625%200.15625%200.125v5.2656l-0.15625%200.14062-0.54688%200.046875zm1.5781-2.9219v-3.0312c0.17188-0.015625%200.34375-0.015625%200.48438-0.015625%201.2344%200%201.8125%200.45312%201.8125%201.4844%200%201.0469-0.57812%201.6094-1.6719%201.6094-0.14062%200-0.35938-0.015625-0.625-0.046875z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22c%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m0.57812-0.1875c0.4375%200.1875%201.0312%200.29688%201.7188%200.29688%201.5312%200%202.4688-0.78125%202.4688-1.9219%200-0.42188-0.14062-0.76562-0.42188-1.0469-0.4375-0.4375-0.95312-0.57812-1.4375-0.78125-0.875-0.375-1.3438-0.60938-1.3438-1.25%200-0.70312%200.5-1.1562%201.3125-1.1562%200.32812%200%200.60938%200.0625%200.85938%200.1875l0.14062%200.17188%200.14062%200.90625h0.5v-1.4844c-0.5625-0.17188-1.1094-0.26562-1.625-0.26562-1.3594%200-2.2188%200.75-2.2188%201.8438%200%200.92188%200.5625%201.2812%201.625%201.7344%201.0469%200.45312%201.5938%200.625%201.5938%201.4062%200%200.67188-0.51562%201.1562-1.4375%201.1562-0.4375%200-0.79688-0.078125-1.0781-0.21875l-0.125-0.17188-0.10938-1.0938h-0.5625z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22b%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m2.5469-3.5312c0.34375-0.015625%200.54688-0.21875%200.54688-0.48438%200-0.32812-0.34375-0.59375-0.89062-0.59375-0.90625%200-1.6406%200.65625-1.6406%201.4375%200%200.54688%200.35938%200.79688%200.90625%201.2188%200.40625%200.29688%200.65625%200.51562%200.65625%200.875%200%200.51562-0.3125%200.8125-0.85938%200.8125-0.29688%200-0.53125-0.10938-0.6875-0.32812l0.17188-0.48438c-0.15625-0.10938-0.28125-0.17188-0.42188-0.17188-0.29688%200-0.48438%200.20312-0.48438%200.5%200%200.48438%200.46875%200.84375%201.2656%200.84375%201.0469%200%201.75-0.64062%201.75-1.4844%200-0.5625-0.39062-0.8125-0.96875-1.2656-0.45312-0.34375-0.71875-0.53125-0.71875-0.875%200-0.375%200.29688-0.64062%200.67188-0.64062%200.10938%200%200.20312%200.015625%200.29688%200.09375z%22/%3E%3C/symbol%3E%3C/defs%3E%3Cg%3E%3Cuse%20x%3D%220.1%22%20y%3D%2212.118%22%20xlink%3Ahref%3D%22%23g%22/%3E%3Cuse%20x%3D%229.121%22%20y%3D%226.622%22%20xlink%3Ahref%3D%22%23f%22/%3E%3Cuse%20x%3D%2215.940275%22%20y%3D%226.622%22%20xlink%3Ahref%3D%22%23e%22/%3E%3Cuse%20x%3D%2220.913659%22%20y%3D%226.622%22%20xlink%3Ahref%3D%22%23a%22/%3E%3Cuse%20x%3D%2227.905089%22%20y%3D%226.622%22%20xlink%3Ahref%3D%22%23a%22/%3E%3Cuse%20x%3D%2234.896519%22%20y%3D%226.622%22%20xlink%3Ahref%3D%22%23d%22/%3E%3Cuse%20x%3D%2240.233343%22%20y%3D%226.622%22%20xlink%3Ahref%3D%22%23c%22/%3E%3Cuse%20x%3D%229.121%22%20y%3D%2216.897%22%20xlink%3Ahref%3D%22%23b%22/%3E%3C/g%3E%3C/svg%3E"/>,
but in principle we can be completely general. Let us define
the number of loops as the <code>NLOOPS</code> variable, and use it
everywhere below.</p>
<pre><span class="tnv">NLOOPS</span> = <span class="tl">2</span>;</pre>
<h2 id="CreatingTheDiagrams">Creating the diagrams</h2>
<p>Generate the diagrams with one incoming photon and one outgoing
photon with QGraf.</p>
<pre><span class="tnv">diagrams</span> = <a class="tnv" href="../alibrary.html#Diagrams">Diagrams</a>[{<span class="ts">"A"</span>}, {<span class="ts">"A"</span>}, <span class="tnv">NLOOPS</span>];
<a class="tnb" href="https://reference.wolfram.com/language/ref/Print.html" rel="nofollow">Print</a>[<span class="ts">"Loaded "</span>, <span class="tnv">diagrams</span>//<a class="tnb" href="https://reference.wolfram.com/language/ref/Length.html" rel="nofollow">Length</a>, <span class="ts">" diagrams"</span>];</pre>
<p>One can now view the graphical representation of these diagrams
directly in Mathematica, or export them to LaTeX; please see
<a href="diagrams.html#DisplayingDiagrams">Displaying diagrams</a> for an example.</p>
<h2 id="TensorProjectors">Tensor projectors</h2>
<p>Because the (amputated) photon propagator has open Lorentz
indices corresponding to the incoming and outgoing photons,
we need to project it to scalar values somehow.</p>
<p>If <img alt="H^{\mu\nu}" style="vertical-align:-0.1pt" src="data:image/svg+xml,%3Csvg%20width%3D%2223.881pt%22%20height%3D%2210.333pt%22%20version%3D%221.1%22%20viewBox%3D%220%200%2023.881%2010.333%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%3E%3Cdefs%3E%3Csymbol%20id%3D%22c%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m1.1562-9.2344v0.51562l0.89062%200.078125%200.14062%200.20312-1.4688%207.6406-0.21875%200.1875-0.89062%200.09375v0.51562h3.3438v-0.51562l-0.875-0.09375-0.17188-0.1875%200.71875-3.7188h4.4844l-0.70312%203.7188-0.21875%200.1875-0.89062%200.09375v0.51562h3.3281v-0.51562l-0.875-0.09375-0.14062-0.1875%201.4688-7.6406%200.21875-0.20312%200.90625-0.078125v-0.51562h-3.3594v0.51562l0.875%200.078125%200.17188%200.20312-0.65625%203.2969h-4.4844l0.65625-3.2969%200.20312-0.20312%200.90625-0.078125v-0.51562z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22b%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m5.3125-4.6406-0.42188%202.1719c-0.10938%200.5625-0.25%201.2188-0.25%201.6719%200%200.3125%200.078125%200.51562%200.23438%200.51562%200.42188%200%200.53125-0.64062%200.65625-1.2812h0.34375c-0.15625%200.875-0.32812%201.6562-1.0625%201.6562-0.40625%200-0.64062-0.32812-0.64062-0.8125%200-0.10938%200-0.21875%200.03125-0.32812-0.45312%200.79688-1.1406%201.1406-2.0156%201.1406-0.70312%200-1.1719-0.54688-1.2188-1.25-0.015625%200.0625-0.015625%200.14062-0.015625%200.20312%200%200.71875%200.39062%202.1406%200.09375%202.6719-0.10938%200.20312-0.29688%200.29688-0.46875%200.29688-0.20312%200-0.35938-0.125-0.35938-0.32812%200-0.03125%200-0.0625%200.015625-0.09375l1.2031-6.2344h0.82812l-0.42188%202.1719c-0.078125%200.40625-0.125%200.78125-0.125%201.0938%200%200.67188%200.1875%201.0938%200.54688%201.0938%200.82812%200%201.5469-0.85938%201.7969-2.1875l0.42188-2.1719z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22a%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m1.2812-3.1719c0.15625-0.78125%200.59375-1.5625%201.2656-1.5625%200.5%200%200.75%200.4375%200.84375%200.90625%200.09375%200.34375%200.125%200.70312%200.125%201.0781%200%200.625-0.10938%201.2656-0.21875%201.9062%200.42188-0.40625%200.78125-0.89062%201.1094-1.3906%200.26562-0.375%200.51562-0.8125%200.51562-1.2031%200-0.09375-0.03125-0.1875-0.046875-0.28125-0.078125-0.1875-0.23438-0.32812-0.23438-0.54688%200-0.23438%200.20312-0.46875%200.42188-0.46875%200.42188%200%200.625%200.29688%200.625%200.73438%200%200.46875-0.25%201.0938-0.71875%201.6719-0.76562%200.9375-1.5312%201.8594-2.5156%202.5625l0.10938-0.54688c0.125-0.64062%200.20312-1.2812%200.20312-1.8906%200-0.48438-0.046875-0.96875-0.20312-1.4062-0.078125-0.23438-0.21875-0.4375-0.4375-0.4375-0.03125%200-0.078125%200.015625-0.10938%200.015625-0.3125%200.10938-0.39062%200.51562-0.45312%200.85938z%22/%3E%3C/symbol%3E%3CclipPath%20id%3D%22e%22%3E%3Cpath%20d%3D%22m0%200h11v10.332h-11z%22/%3E%3C/clipPath%3E%3CclipPath%20id%3D%22d%22%3E%3Cpath%20d%3D%22m11%200h12.883v7h-12.883z%22/%3E%3C/clipPath%3E%3C/defs%3E%3Cg%3E%3Cg%20clip-path%3D%22url%28%23e%29%22%3E%3Cg%3E%3Cuse%20x%3D%220.444%22%20y%3D%2210.233%22%20xlink%3Ahref%3D%22%23c%22/%3E%3C/g%3E%3C/g%3E%3Cg%20clip-path%3D%22url%28%23d%29%22%3E%3Cg%3E%3Cuse%20x%3D%2211.338%22%20y%3D%224.738%22%20xlink%3Ahref%3D%22%23b%22/%3E%3Cuse%20x%3D%2217.545166%22%20y%3D%224.738%22%20xlink%3Ahref%3D%22%23a%22/%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E"/> is the propagator, and <img alt="q" style="vertical-align:-3.1067291259765626pt" src="data:image/svg+xml,%3Csvg%20width%3D%227.595pt%22%20height%3D%229.874pt%22%20version%3D%221.1%22%20viewBox%3D%220%200%207.595%209.874%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%3E%3Cdefs%3E%3Csymbol%20id%3D%22a%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m5.7031-6.7031-0.35938%200.34375c-0.46875-0.20312-0.90625-0.34375-1.3125-0.34375-0.96875%200-2.0312%200.5625-2.7812%201.5469-0.59375%200.76562-0.90625%201.7188-0.90625%202.7812%200%201.5469%200.73438%202.4531%201.8594%202.4531%200.64062%200%201.3281-0.34375%202.0469-1.0312l-0.54688%203.1875-0.15625%200.15625-0.82812%200.17188v0.4375h3.375v-0.4375l-1.3125-0.23438%201.4219-8.375c0.03125-0.17188%200.09375-0.375%200.15625-0.65625zm-1.375%200.59375%200.6875%200.84375-0.67188%203.7188c-0.5625%200.5625-1.0781%200.82812-1.6094%200.82812-0.78125%200-1.2812-0.59375-1.2812-1.5781%200-1.1875%200.42188-2.3281%200.92188-2.9531%200.5-0.59375%201.0469-0.875%201.6719-0.875%200.09375%200%200.17188%200%200.28125%200.015625z%22/%3E%3C/symbol%3E%3CclipPath%20id%3D%22b%22%3E%3Cpath%20d%3D%22m0%200h7v9.875h-7z%22/%3E%3C/clipPath%3E%3C/defs%3E%3Cg%20clip-path%3D%22url%28%23b%29%22%3E%3Cg%3E%3Cuse%20x%3D%220.1%22%20y%3D%226.779%22%20xlink%3Ahref%3D%22%23a%22/%3E%3C/g%3E%3C/g%3E%3C/svg%3E"/> is the momentum
flowing through it, there are two tensor structures that it
can be made of:</p>
<p><img alt="H^{\mu\nu} = A g^{\mu\nu} + B q^\mu q^\nu." class="display" style="vertical-align:-3.1067291259765626pt" src="data:image/svg+xml,%3Csvg%20width%3D%22125.66pt%22%20height%3D%2213.687pt%22%20version%3D%221.1%22%20viewBox%3D%220%200%20125.66%2013.687%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%3E%3Cdefs%3E%3Csymbol%20id%3D%22j%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m1.1562-9.2344v0.51562l0.89062%200.078125%200.14062%200.20312-1.4688%207.6406-0.21875%200.1875-0.89062%200.09375v0.51562h3.3438v-0.51562l-0.875-0.09375-0.17188-0.1875%200.71875-3.7188h4.4844l-0.70312%203.7188-0.21875%200.1875-0.89062%200.09375v0.51562h3.3281v-0.51562l-0.875-0.09375-0.14062-0.1875%201.4688-7.6406%200.21875-0.20312%200.90625-0.078125v-0.51562h-3.3594v0.51562l0.875%200.078125%200.17188%200.20312-0.65625%203.2969h-4.4844l0.65625-3.2969%200.20312-0.20312%200.90625-0.078125v-0.51562z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22i%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m4.75-9.3125-5.0781%208.7031-0.76562%200.09375v0.51562h2.7344v-0.51562l-0.84375-0.078125-0.10938-0.1875%201.4688-2.625h3.3438l0.4375%202.625-0.09375%200.1875-0.8125%200.078125v0.51562h3.0156v-0.51562l-0.6875-0.078125-0.23438-0.25-1.4688-8.4688zm0%201.3438%200.625%203.9688h-2.875z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22h%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m4.6406-6.2969c-0.42188-0.23438-0.84375-0.35938-1.2812-0.35938-1.5%200-2.6875%201.1719-2.6875%202.6719%200%200.73438%200.4375%201.3438%201.2656%201.6719-0.375%200.46875-0.54688%200.875-0.54688%201.3281%200%200.09375%200%200.15625%200.015625%200.23438-1.2344%200.48438-1.8281%201.0469-1.8281%201.9219%200%201.0938%200.98438%201.8281%202.5938%201.8281%201.9062%200%203.3281-1.0312%203.3281-2.0469%200-0.59375-0.35938-1.0312-1.0781-1.3594l-2.1875-1v-0.078125c0-0.26562%200.046875-0.5%200.17188-0.73438%200.1875%200.015625%200.29688%200.015625%200.3125%200.015625%201.4219%200%202.6562-1.0938%202.6562-2.5938%200-0.29688-0.0625-0.59375-0.1875-0.92188h1.4219v-0.57812zm-0.35938%201.4062c0%201.25-0.8125%202.2188-1.5938%202.2188-0.5625%200-0.92188-0.40625-0.92188-1.1562%200-1.2969%200.78125-2.3125%201.5781-2.3125%200.59375%200%200.9375%200.4375%200.9375%201.25zm-2.375%204.4219%201.75%200.8125c0.53125%200.23438%200.78125%200.53125%200.78125%200.875%200%200.625-0.73438%201.2031-1.9375%201.2031-1.0938%200-1.8594-0.64062-1.8594-1.5312%200-0.70312%200.45312-1.1719%201.2656-1.3594z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22g%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m1.1562-9.2344v0.51562l0.875%200.078125%200.14062%200.20312-1.4531%207.6406-0.23438%200.1875-0.875%200.09375v0.51562h3.4531c2.7812%200%204.1562-1%204.1562-3.0625%200-1.1406-0.75-1.7656-2.1875-1.8438%201.6094-0.39062%202.4375-1.2969%202.4375-2.6094%200-1.2031-0.92188-1.7188-2.7812-1.7188zm1.5781%204.1562%200.67188-3.5781c0.32812-0.03125%200.57812-0.046875%200.75-0.046875%201.3281%200%201.9531%200.42188%201.9531%201.3281%200%201.4062-0.98438%202.3438-2.6719%202.3438-0.17188%200-0.39062-0.015625-0.70312-0.046875zm-0.84375%204.4688%200.73438-3.8281c0.45312-0.03125%200.8125-0.0625%201.0625-0.0625%201.4688%200%202.1719%200.45312%202.1719%201.5312%200%201.5938-1.0312%202.4062-3.0625%202.4062-0.29688%200-0.59375-0.015625-0.90625-0.046875z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22c%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m5.7031-6.7031-0.35938%200.34375c-0.46875-0.20312-0.90625-0.34375-1.3125-0.34375-0.96875%200-2.0312%200.5625-2.7812%201.5469-0.59375%200.76562-0.90625%201.7188-0.90625%202.7812%200%201.5469%200.73438%202.4531%201.8594%202.4531%200.64062%200%201.3281-0.34375%202.0469-1.0312l-0.54688%203.1875-0.15625%200.15625-0.82812%200.17188v0.4375h3.375v-0.4375l-1.3125-0.23438%201.4219-8.375c0.03125-0.17188%200.09375-0.375%200.15625-0.65625zm-1.375%200.59375%200.6875%200.84375-0.67188%203.7188c-0.5625%200.5625-1.0781%200.82812-1.6094%200.82812-0.78125%200-1.2812-0.59375-1.2812-1.5781%200-1.1875%200.42188-2.3281%200.92188-2.9531%200.5-0.59375%201.0469-0.875%201.6719-0.875%200.09375%200%200.17188%200%200.28125%200.015625z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22b%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m5.3125-4.6406-0.42188%202.1719c-0.10938%200.5625-0.25%201.2188-0.25%201.6719%200%200.3125%200.078125%200.51562%200.23438%200.51562%200.42188%200%200.53125-0.64062%200.65625-1.2812h0.34375c-0.15625%200.875-0.32812%201.6562-1.0625%201.6562-0.40625%200-0.64062-0.32812-0.64062-0.8125%200-0.10938%200-0.21875%200.03125-0.32812-0.45312%200.79688-1.1406%201.1406-2.0156%201.1406-0.70312%200-1.1719-0.54688-1.2188-1.25-0.015625%200.0625-0.015625%200.14062-0.015625%200.20312%200%200.71875%200.39062%202.1406%200.09375%202.6719-0.10938%200.20312-0.29688%200.29688-0.46875%200.29688-0.20312%200-0.35938-0.125-0.35938-0.32812%200-0.03125%200-0.0625%200.015625-0.09375l1.2031-6.2344h0.82812l-0.42188%202.1719c-0.078125%200.40625-0.125%200.78125-0.125%201.0938%200%200.67188%200.1875%201.0938%200.54688%201.0938%200.82812%200%201.5469-0.85938%201.7969-2.1875l0.42188-2.1719z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22a%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m1.2812-3.1719c0.15625-0.78125%200.59375-1.5625%201.2656-1.5625%200.5%200%200.75%200.4375%200.84375%200.90625%200.09375%200.34375%200.125%200.70312%200.125%201.0781%200%200.625-0.10938%201.2656-0.21875%201.9062%200.42188-0.40625%200.78125-0.89062%201.1094-1.3906%200.26562-0.375%200.51562-0.8125%200.51562-1.2031%200-0.09375-0.03125-0.1875-0.046875-0.28125-0.078125-0.1875-0.23438-0.32812-0.23438-0.54688%200-0.23438%200.20312-0.46875%200.42188-0.46875%200.42188%200%200.625%200.29688%200.625%200.73438%200%200.46875-0.25%201.0938-0.71875%201.6719-0.76562%200.9375-1.5312%201.8594-2.5156%202.5625l0.10938-0.54688c0.125-0.64062%200.20312-1.2812%200.20312-1.8906%200-0.48438-0.046875-0.96875-0.20312-1.4062-0.078125-0.23438-0.21875-0.4375-0.4375-0.4375-0.03125%200-0.078125%200.015625-0.10938%200.015625-0.3125%200.10938-0.39062%200.51562-0.45312%200.85938z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22f%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m0.76562-5.0312h9.25v-0.82812h-9.25zm0%202.9688h9.25v-0.82812h-9.25z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22e%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m4.5938-3.5469v3.8281h0.82812v-3.8281h3.8281v-0.82812h-3.8281v-3.8281h-0.82812v3.8281h-3.8281v0.82812z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22d%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m1.9062-1.625c-0.46875%200-0.875%200.39062-0.875%200.875%200%200.5%200.40625%200.875%200.875%200.875%200.48438%200%200.875-0.39062%200.875-0.875s-0.39062-0.875-0.875-0.875z%22/%3E%3C/symbol%3E%3CclipPath%20id%3D%22m%22%3E%3Cpath%20d%3D%22m49%203h8v10.688h-8z%22/%3E%3C/clipPath%3E%3CclipPath%20id%3D%22l%22%3E%3Cpath%20d%3D%22m94%203h7v10.688h-7z%22/%3E%3C/clipPath%3E%3CclipPath%20id%3D%22k%22%3E%3Cpath%20d%3D%22m108%203h7v10.688h-7z%22/%3E%3C/clipPath%3E%3C/defs%3E%3Cg%3E%3Cuse%20x%3D%220.444%22%20y%3D%2210.592%22%20xlink%3Ahref%3D%22%23j%22/%3E%3Cuse%20x%3D%2211.338%22%20y%3D%224.739%22%20xlink%3Ahref%3D%22%23b%22/%3E%3Cuse%20x%3D%2217.545166%22%20y%3D%224.739%22%20xlink%3Ahref%3D%22%23a%22/%3E%3Cuse%20x%3D%2226.984%22%20y%3D%2210.592%22%20xlink%3Ahref%3D%22%23f%22/%3E%3Cuse%20x%3D%2241.025%22%20y%3D%2210.592%22%20xlink%3Ahref%3D%22%23i%22/%3E%3C/g%3E%3Cg%20clip-path%3D%22url%28%23m%29%22%3E%3Cg%3E%3Cuse%20x%3D%2249.715384%22%20y%3D%2210.592%22%20xlink%3Ahref%3D%22%23h%22/%3E%3C/g%3E%3C/g%3E%3Cg%3E%3Cuse%20x%3D%2257.373%22%20y%3D%224.739%22%20xlink%3Ahref%3D%22%23b%22/%3E%3Cuse%20x%3D%2263.580166%22%20y%3D%224.739%22%20xlink%3Ahref%3D%22%23a%22/%3E%3Cuse%20x%3D%2272.378%22%20y%3D%2210.592%22%20xlink%3Ahref%3D%22%23e%22/%3E%3Cuse%20x%3D%2285.352%22%20y%3D%2210.592%22%20xlink%3Ahref%3D%22%23g%22/%3E%3C/g%3E%3Cg%20clip-path%3D%22url%28%23l%29%22%3E%3Cg%3E%3Cuse%20x%3D%2294.001067%22%20y%3D%2210.592%22%20xlink%3Ahref%3D%22%23c%22/%3E%3C/g%3E%3C/g%3E%3Cg%3E%3Cuse%20x%3D%22101.396%22%20y%3D%224.739%22%20xlink%3Ahref%3D%22%23b%22/%3E%3C/g%3E%3Cg%20clip-path%3D%22url%28%23k%29%22%3E%3Cg%3E%3Cuse%20x%3D%22108.102%22%20y%3D%2210.592%22%20xlink%3Ahref%3D%22%23c%22/%3E%3C/g%3E%3C/g%3E%3Cg%3E%3Cuse%20x%3D%22115.498%22%20y%3D%224.739%22%20xlink%3Ahref%3D%22%23a%22/%3E%3Cuse%20x%3D%22121.734%22%20y%3D%2210.592%22%20xlink%3Ahref%3D%22%23d%22/%3E%3C/g%3E%3C/svg%3E"/></p>
<p>Because of the Ward identities,</p>
<p><img alt="q_\mu H^{\mu\nu} = H^{\mu\nu} q_\nu = 0," class="display" style="vertical-align:-5.312234497070312pt" src="data:image/svg+xml,%3Csvg%20width%3D%22120.58pt%22%20height%3D%2215.884pt%22%20version%3D%221.1%22%20viewBox%3D%220%200%20120.58%2015.884%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%3E%3Cdefs%3E%3Csymbol%20id%3D%22e%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m5.7031-6.7031-0.35938%200.34375c-0.46875-0.20312-0.90625-0.34375-1.3125-0.34375-0.96875%200-2.0312%200.5625-2.7812%201.5469-0.59375%200.76562-0.90625%201.7188-0.90625%202.7812%200%201.5469%200.73438%202.4531%201.8594%202.4531%200.64062%200%201.3281-0.34375%202.0469-1.0312l-0.54688%203.1875-0.15625%200.15625-0.82812%200.17188v0.4375h3.375v-0.4375l-1.3125-0.23438%201.4219-8.375c0.03125-0.17188%200.09375-0.375%200.15625-0.65625zm-1.375%200.59375%200.6875%200.84375-0.67188%203.7188c-0.5625%200.5625-1.0781%200.82812-1.6094%200.82812-0.78125%200-1.2812-0.59375-1.2812-1.5781%200-1.1875%200.42188-2.3281%200.92188-2.9531%200.5-0.59375%201.0469-0.875%201.6719-0.875%200.09375%200%200.17188%200%200.28125%200.015625z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22d%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m1.1562-9.2344v0.51562l0.89062%200.078125%200.14062%200.20312-1.4688%207.6406-0.21875%200.1875-0.89062%200.09375v0.51562h3.3438v-0.51562l-0.875-0.09375-0.17188-0.1875%200.71875-3.7188h4.4844l-0.70312%203.7188-0.21875%200.1875-0.89062%200.09375v0.51562h3.3281v-0.51562l-0.875-0.09375-0.14062-0.1875%201.4688-7.6406%200.21875-0.20312%200.90625-0.078125v-0.51562h-3.3594v0.51562l0.875%200.078125%200.17188%200.20312-0.65625%203.2969h-4.4844l0.65625-3.2969%200.20312-0.20312%200.90625-0.078125v-0.51562z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22b%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m5.3125-4.6406-0.42188%202.1719c-0.10938%200.5625-0.25%201.2188-0.25%201.6719%200%200.3125%200.078125%200.51562%200.23438%200.51562%200.42188%200%200.53125-0.64062%200.65625-1.2812h0.34375c-0.15625%200.875-0.32812%201.6562-1.0625%201.6562-0.40625%200-0.64062-0.32812-0.64062-0.8125%200-0.10938%200-0.21875%200.03125-0.32812-0.45312%200.79688-1.1406%201.1406-2.0156%201.1406-0.70312%200-1.1719-0.54688-1.2188-1.25-0.015625%200.0625-0.015625%200.14062-0.015625%200.20312%200%200.71875%200.39062%202.1406%200.09375%202.6719-0.10938%200.20312-0.29688%200.29688-0.46875%200.29688-0.20312%200-0.35938-0.125-0.35938-0.32812%200-0.03125%200-0.0625%200.015625-0.09375l1.2031-6.2344h0.82812l-0.42188%202.1719c-0.078125%200.40625-0.125%200.78125-0.125%201.0938%200%200.67188%200.1875%201.0938%200.54688%201.0938%200.82812%200%201.5469-0.85938%201.7969-2.1875l0.42188-2.1719z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22a%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m1.2812-3.1719c0.15625-0.78125%200.59375-1.5625%201.2656-1.5625%200.5%200%200.75%200.4375%200.84375%200.90625%200.09375%200.34375%200.125%200.70312%200.125%201.0781%200%200.625-0.10938%201.2656-0.21875%201.9062%200.42188-0.40625%200.78125-0.89062%201.1094-1.3906%200.26562-0.375%200.51562-0.8125%200.51562-1.2031%200-0.09375-0.03125-0.1875-0.046875-0.28125-0.078125-0.1875-0.23438-0.32812-0.23438-0.54688%200-0.23438%200.20312-0.46875%200.42188-0.46875%200.42188%200%200.625%200.29688%200.625%200.73438%200%200.46875-0.25%201.0938-0.71875%201.6719-0.76562%200.9375-1.5312%201.8594-2.5156%202.5625l0.10938-0.54688c0.125-0.64062%200.20312-1.2812%200.20312-1.8906%200-0.48438-0.046875-0.96875-0.20312-1.4062-0.078125-0.23438-0.21875-0.4375-0.4375-0.4375-0.03125%200-0.078125%200.015625-0.10938%200.015625-0.3125%200.10938-0.39062%200.51562-0.45312%200.85938z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22c%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m0.76562-5.0312h9.25v-0.82812h-9.25zm0%202.9688h9.25v-0.82812h-9.25z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22g%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m3.8281-9.4062c-1.9688%200-3.2656%201.7344-3.2656%204.7812s1.2969%204.7969%203.2656%204.7969%203.2656-1.75%203.2656-4.7969-1.2969-4.7812-3.2656-4.7812zm0%200.65625c1.2656%200%201.9531%201.4062%201.9531%204.125s-0.6875%204.125-1.9531%204.125-1.9688-1.3906-1.9688-4.1094c0-2.7344%200.70312-4.1406%201.9688-4.1406z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22f%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m0.53125%202.3281c1.3906-0.15625%202.3281-1.2344%202.3281-2.4062%200-0.89062-0.40625-1.375-1.0938-1.375-0.46875%200-0.8125%200.29688-0.8125%200.75%200%200.25%200.0625%200.4375%200.21875%200.60938h0.875v0.15625c0%201-0.5%201.6094-1.5156%201.8125z%22/%3E%3C/symbol%3E%3CclipPath%20id%3D%22h%22%3E%3Cpath%20d%3D%22m7%209h7v6.8828h-7z%22/%3E%3C/clipPath%3E%3C/defs%3E%3Cg%3E%3Cuse%20x%3D%220.1%22%20y%3D%2210.592%22%20xlink%3Ahref%3D%22%23e%22/%3E%3C/g%3E%3Cg%20clip-path%3D%22url%28%23h%29%22%3E%3Cg%3E%3Cuse%20x%3D%227.151%22%20y%3D%2213.704%22%20xlink%3Ahref%3D%22%23b%22/%3E%3C/g%3E%3C/g%3E%3Cg%3E%3Cuse%20x%3D%2214.201%22%20y%3D%2210.592%22%20xlink%3Ahref%3D%22%23d%22/%3E%3Cuse%20x%3D%2225.095%22%20y%3D%224.738%22%20xlink%3Ahref%3D%22%23b%22/%3E%3Cuse%20x%3D%2231.302166%22%20y%3D%224.738%22%20xlink%3Ahref%3D%22%23a%22/%3E%3Cuse%20x%3D%2240.741%22%20y%3D%2210.592%22%20xlink%3Ahref%3D%22%23c%22/%3E%3Cuse%20x%3D%2255.126%22%20y%3D%2210.592%22%20xlink%3Ahref%3D%22%23d%22/%3E%3Cuse%20x%3D%2266.02%22%20y%3D%224.738%22%20xlink%3Ahref%3D%22%23b%22/%3E%3Cuse%20x%3D%2272.227166%22%20y%3D%224.738%22%20xlink%3Ahref%3D%22%23a%22/%3E%3Cuse%20x%3D%2278.464%22%20y%3D%2210.592%22%20xlink%3Ahref%3D%22%23e%22/%3E%3Cuse%20x%3D%2285.515%22%20y%3D%2213.704%22%20xlink%3Ahref%3D%22%23a%22/%3E%3Cuse%20x%3D%2294.954%22%20y%3D%2210.592%22%20xlink%3Ahref%3D%22%23c%22/%3E%3Cuse%20x%3D%22108.995%22%20y%3D%2210.592%22%20xlink%3Ahref%3D%22%23g%22/%3E%3Cuse%20x%3D%22116.652454%22%20y%3D%2210.592%22%20xlink%3Ahref%3D%22%23f%22/%3E%3C/g%3E%3C/svg%3E"/></p>
<p>this form is further constrained to just</p>
<p><img alt="H^{\mu\nu} = H ( g^{\mu\nu} - q^\mu q^\nu / q^2 )." class="display" style="vertical-align:-3.1067291259765626pt" src="data:image/svg+xml,%3Csvg%20width%3D%22151.26pt%22%20height%3D%2215.614pt%22%20version%3D%221.1%22%20viewBox%3D%220%200%20151.26%2015.614%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%3E%3Cdefs%3E%3Csymbol%20id%3D%22d%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m1.1562-9.2344v0.51562l0.89062%200.078125%200.14062%200.20312-1.4688%207.6406-0.21875%200.1875-0.89062%200.09375v0.51562h3.3438v-0.51562l-0.875-0.09375-0.17188-0.1875%200.71875-3.7188h4.4844l-0.70312%203.7188-0.21875%200.1875-0.89062%200.09375v0.51562h3.3281v-0.51562l-0.875-0.09375-0.14062-0.1875%201.4688-7.6406%200.21875-0.20312%200.90625-0.078125v-0.51562h-3.3594v0.51562l0.875%200.078125%200.17188%200.20312-0.65625%203.2969h-4.4844l0.65625-3.2969%200.20312-0.20312%200.90625-0.078125v-0.51562z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22l%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m4.6406-6.2969c-0.42188-0.23438-0.84375-0.35938-1.2812-0.35938-1.5%200-2.6875%201.1719-2.6875%202.6719%200%200.73438%200.4375%201.3438%201.2656%201.6719-0.375%200.46875-0.54688%200.875-0.54688%201.3281%200%200.09375%200%200.15625%200.015625%200.23438-1.2344%200.48438-1.8281%201.0469-1.8281%201.9219%200%201.0938%200.98438%201.8281%202.5938%201.8281%201.9062%200%203.3281-1.0312%203.3281-2.0469%200-0.59375-0.35938-1.0312-1.0781-1.3594l-2.1875-1v-0.078125c0-0.26562%200.046875-0.5%200.17188-0.73438%200.1875%200.015625%200.29688%200.015625%200.3125%200.015625%201.4219%200%202.6562-1.0938%202.6562-2.5938%200-0.29688-0.0625-0.59375-0.1875-0.92188h1.4219v-0.57812zm-0.35938%201.4062c0%201.25-0.8125%202.2188-1.5938%202.2188-0.5625%200-0.92188-0.40625-0.92188-1.1562%200-1.2969%200.78125-2.3125%201.5781-2.3125%200.59375%200%200.9375%200.4375%200.9375%201.25zm-2.375%204.4219%201.75%200.8125c0.53125%200.23438%200.78125%200.53125%200.78125%200.875%200%200.625-0.73438%201.2031-1.9375%201.2031-1.0938%200-1.8594-0.64062-1.8594-1.5312%200-0.70312%200.45312-1.1719%201.2656-1.3594z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22c%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m5.7031-6.7031-0.35938%200.34375c-0.46875-0.20312-0.90625-0.34375-1.3125-0.34375-0.96875%200-2.0312%200.5625-2.7812%201.5469-0.59375%200.76562-0.90625%201.7188-0.90625%202.7812%200%201.5469%200.73438%202.4531%201.8594%202.4531%200.64062%200%201.3281-0.34375%202.0469-1.0312l-0.54688%203.1875-0.15625%200.15625-0.82812%200.17188v0.4375h3.375v-0.4375l-1.3125-0.23438%201.4219-8.375c0.03125-0.17188%200.09375-0.375%200.15625-0.65625zm-1.375%200.59375%200.6875%200.84375-0.67188%203.7188c-0.5625%200.5625-1.0781%200.82812-1.6094%200.82812-0.78125%200-1.2812-0.59375-1.2812-1.5781%200-1.1875%200.42188-2.3281%200.92188-2.9531%200.5-0.59375%201.0469-0.875%201.6719-0.875%200.09375%200%200.17188%200%200.28125%200.015625z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22b%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m5.3125-4.6406-0.42188%202.1719c-0.10938%200.5625-0.25%201.2188-0.25%201.6719%200%200.3125%200.078125%200.51562%200.23438%200.51562%200.42188%200%200.53125-0.64062%200.65625-1.2812h0.34375c-0.15625%200.875-0.32812%201.6562-1.0625%201.6562-0.40625%200-0.64062-0.32812-0.64062-0.8125%200-0.10938%200-0.21875%200.03125-0.32812-0.45312%200.79688-1.1406%201.1406-2.0156%201.1406-0.70312%200-1.1719-0.54688-1.2188-1.25-0.015625%200.0625-0.015625%200.14062-0.015625%200.20312%200%200.71875%200.39062%202.1406%200.09375%202.6719-0.10938%200.20312-0.29688%200.29688-0.46875%200.29688-0.20312%200-0.35938-0.125-0.35938-0.32812%200-0.03125%200-0.0625%200.015625-0.09375l1.2031-6.2344h0.82812l-0.42188%202.1719c-0.078125%200.40625-0.125%200.78125-0.125%201.0938%200%200.67188%200.1875%201.0938%200.54688%201.0938%200.82812%200%201.5469-0.85938%201.7969-2.1875l0.42188-2.1719z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22a%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m1.2812-3.1719c0.15625-0.78125%200.59375-1.5625%201.2656-1.5625%200.5%200%200.75%200.4375%200.84375%200.90625%200.09375%200.34375%200.125%200.70312%200.125%201.0781%200%200.625-0.10938%201.2656-0.21875%201.9062%200.42188-0.40625%200.78125-0.89062%201.1094-1.3906%200.26562-0.375%200.51562-0.8125%200.51562-1.2031%200-0.09375-0.03125-0.1875-0.046875-0.28125-0.078125-0.1875-0.23438-0.32812-0.23438-0.54688%200-0.23438%200.20312-0.46875%200.42188-0.46875%200.42188%200%200.625%200.29688%200.625%200.73438%200%200.46875-0.25%201.0938-0.71875%201.6719-0.76562%200.9375-1.5312%201.8594-2.5156%202.5625l0.10938-0.54688c0.125-0.64062%200.20312-1.2812%200.20312-1.8906%200-0.48438-0.046875-0.96875-0.20312-1.4062-0.078125-0.23438-0.21875-0.4375-0.4375-0.4375-0.03125%200-0.078125%200.015625-0.10938%200.015625-0.3125%200.10938-0.39062%200.51562-0.45312%200.85938z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22k%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m0.76562-5.0312h9.25v-0.82812h-9.25zm0%202.9688h9.25v-0.82812h-9.25z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22j%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m1.9375-3.9688c0-3.7656%201.1094-5.6406%202.6875-5.9219v-0.625c-2.2812%200.28125-3.8594%202.3906-3.8594%206.5469s1.5781%206.2812%203.8594%206.5625v-0.64062c-1.5781-0.28125-2.6875-2.1406-2.6875-5.9219z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22i%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m3.4531-3.9688c0%203.7812-1.0938%205.6406-2.6875%205.9219v0.64062c2.2969-0.28125%203.8594-2.4062%203.8594-6.5625s-1.5625-6.2656-3.8594-6.5469v0.625c1.5938%200.28125%202.6875%202.1562%202.6875%205.9219z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22h%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m0.32812-3.5469h9.3594v-0.82812h-9.3594z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22g%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m6.1719-10.516h-0.875l-4.5312%2013.109h0.875z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22f%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m1.3438-0.75c2.125-1.6875%203.2812-2.7656%203.2812-3.9688%200-1.0781-0.76562-1.8125-2-1.8125-1.1875%200-2.0156%200.67188-2.0156%201.3438%200%200.32812%200.1875%200.54688%200.53125%200.54688%200.15625%200%200.29688-0.046875%200.42188-0.15625v-1.0156c0.29688-0.15625%200.5625-0.23438%200.85938-0.23438%200.79688%200%201.2656%200.53125%201.2656%201.4531%200%201.25-1.1875%202.2969-3.2812%203.9844v0.60938h4.4219v-1.5625h-0.42188l-0.17188%200.8125z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22e%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m1.9062-1.625c-0.46875%200-0.875%200.39062-0.875%200.875%200%200.5%200.40625%200.875%200.875%200.875%200.48438%200%200.875-0.39062%200.875-0.875s-0.39062-0.875-0.875-0.875z%22/%3E%3C/symbol%3E%3CclipPath%20id%3D%22s%22%3E%3Cpath%20d%3D%22m53%201h4v14.613h-4z%22/%3E%3C/clipPath%3E%3CclipPath%20id%3D%22r%22%3E%3Cpath%20d%3D%22m58%205h8v10.613h-8z%22/%3E%3C/clipPath%3E%3CclipPath%20id%3D%22q%22%3E%3Cpath%20d%3D%22m94%205h7v10.613h-7z%22/%3E%3C/clipPath%3E%3CclipPath%20id%3D%22p%22%3E%3Cpath%20d%3D%22m108%205h7v10.613h-7z%22/%3E%3C/clipPath%3E%3CclipPath%20id%3D%22o%22%3E%3Cpath%20d%3D%22m122%201h6v14.613h-6z%22/%3E%3C/clipPath%3E%3CclipPath%20id%3D%22n%22%3E%3Cpath%20d%3D%22m129%205h7v10.613h-7z%22/%3E%3C/clipPath%3E%3CclipPath%20id%3D%22m%22%3E%3Cpath%20d%3D%22m142%201h5v14.613h-5z%22/%3E%3C/clipPath%3E%3C/defs%3E%3Cg%3E%3Cuse%20x%3D%220.444%22%20y%3D%2212.519%22%20xlink%3Ahref%3D%22%23d%22/%3E%3Cuse%20x%3D%2211.338%22%20y%3D%226.666%22%20xlink%3Ahref%3D%22%23b%22/%3E%3Cuse%20x%3D%2217.545166%22%20y%3D%226.666%22%20xlink%3Ahref%3D%22%23a%22/%3E%3Cuse%20x%3D%2226.984%22%20y%3D%2212.519%22%20xlink%3Ahref%3D%22%23k%22/%3E%3Cuse%20x%3D%2241.369%22%20y%3D%2212.519%22%20xlink%3Ahref%3D%22%23d%22/%3E%3C/g%3E%3Cg%20clip-path%3D%22url%28%23s%29%22%3E%3Cg%3E%3Cuse%20x%3D%2252.263%22%20y%3D%2212.519%22%20xlink%3Ahref%3D%22%23j%22/%3E%3C/g%3E%3C/g%3E%3Cg%20clip-path%3D%22url%28%23r%29%22%3E%3Cg%3E%3Cuse%20x%3D%2258.708%22%20y%3D%2212.519%22%20xlink%3Ahref%3D%22%23l%22/%3E%3C/g%3E%3C/g%3E%3Cg%3E%3Cuse%20x%3D%2266.366%22%20y%3D%226.666%22%20xlink%3Ahref%3D%22%23b%22/%3E%3Cuse%20x%3D%2272.573166%22%20y%3D%226.666%22%20xlink%3Ahref%3D%22%23a%22/%3E%3Cuse%20x%3D%2281.371%22%20y%3D%2212.519%22%20xlink%3Ahref%3D%22%23h%22/%3E%3C/g%3E%3Cg%20clip-path%3D%22url%28%23q%29%22%3E%3Cg%3E%3Cuse%20x%3D%2294.001%22%20y%3D%2212.519%22%20xlink%3Ahref%3D%22%23c%22/%3E%3C/g%3E%3C/g%3E%3Cg%3E%3Cuse%20x%3D%22101.396%22%20y%3D%226.666%22%20xlink%3Ahref%3D%22%23b%22/%3E%3C/g%3E%3Cg%20clip-path%3D%22url%28%23p%29%22%3E%3Cg%3E%3Cuse%20x%3D%22108.102%22%20y%3D%2212.519%22%20xlink%3Ahref%3D%22%23c%22/%3E%3C/g%3E%3C/g%3E%3Cg%3E%3Cuse%20x%3D%22115.497%22%20y%3D%226.666%22%20xlink%3Ahref%3D%22%23a%22/%3E%3C/g%3E%3Cg%20clip-path%3D%22url%28%23o%29%22%3E%3Cg%3E%3Cuse%20x%3D%22121.734%22%20y%3D%2212.519%22%20xlink%3Ahref%3D%22%23g%22/%3E%3C/g%3E%3C/g%3E%3Cg%20clip-path%3D%22url%28%23n%29%22%3E%3Cg%3E%3Cuse%20x%3D%22128.703%22%20y%3D%2212.519%22%20xlink%3Ahref%3D%22%23c%22/%3E%3C/g%3E%3C/g%3E%3Cg%3E%3Cuse%20x%3D%22136.099%22%20y%3D%226.666%22%20xlink%3Ahref%3D%22%23f%22/%3E%3C/g%3E%3Cg%20clip-path%3D%22url%28%23m%29%22%3E%3Cg%3E%3Cuse%20x%3D%22141.915%22%20y%3D%2212.519%22%20xlink%3Ahref%3D%22%23i%22/%3E%3C/g%3E%3C/g%3E%3Cg%3E%3Cuse%20x%3D%22147.327%22%20y%3D%2212.519%22%20xlink%3Ahref%3D%22%23e%22/%3E%3C/g%3E%3C/svg%3E"/></p>
<p>Then to get the scalar <img alt="H" style="vertical-align:-0.1pt" src="data:image/svg+xml,%3Csvg%20width%3D%2211.438pt%22%20height%3D%229.482pt%22%20version%3D%221.1%22%20viewBox%3D%220%200%2011.438%209.482%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%3E%3Cdefs%3E%3Csymbol%20id%3D%22a%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m1.1562-9.2344v0.51562l0.89062%200.078125%200.14062%200.20312-1.4688%207.6406-0.21875%200.1875-0.89062%200.09375v0.51562h3.3438v-0.51562l-0.875-0.09375-0.17188-0.1875%200.71875-3.7188h4.4844l-0.70312%203.7188-0.21875%200.1875-0.89062%200.09375v0.51562h3.3281v-0.51562l-0.875-0.09375-0.14062-0.1875%201.4688-7.6406%200.21875-0.20312%200.90625-0.078125v-0.51562h-3.3594v0.51562l0.875%200.078125%200.17188%200.20312-0.65625%203.2969h-4.4844l0.65625-3.2969%200.20312-0.20312%200.90625-0.078125v-0.51562z%22/%3E%3C/symbol%3E%3CclipPath%20id%3D%22b%22%3E%3Cpath%20d%3D%22m0%200h11v9.4805h-11z%22/%3E%3C/clipPath%3E%3C/defs%3E%3Cg%20clip-path%3D%22url%28%23b%29%22%3E%3Cg%3E%3Cuse%20x%3D%220.444%22%20y%3D%229.382%22%20xlink%3Ahref%3D%22%23a%22/%3E%3C/g%3E%3C/g%3E%3C/svg%3E"/> from <img alt="H^{\mu\nu}" style="vertical-align:-0.1pt" src="data:image/svg+xml,%3Csvg%20width%3D%2223.881pt%22%20height%3D%2210.333pt%22%20version%3D%221.1%22%20viewBox%3D%220%200%2023.881%2010.333%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%3E%3Cdefs%3E%3Csymbol%20id%3D%22c%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m1.1562-9.2344v0.51562l0.89062%200.078125%200.14062%200.20312-1.4688%207.6406-0.21875%200.1875-0.89062%200.09375v0.51562h3.3438v-0.51562l-0.875-0.09375-0.17188-0.1875%200.71875-3.7188h4.4844l-0.70312%203.7188-0.21875%200.1875-0.89062%200.09375v0.51562h3.3281v-0.51562l-0.875-0.09375-0.14062-0.1875%201.4688-7.6406%200.21875-0.20312%200.90625-0.078125v-0.51562h-3.3594v0.51562l0.875%200.078125%200.17188%200.20312-0.65625%203.2969h-4.4844l0.65625-3.2969%200.20312-0.20312%200.90625-0.078125v-0.51562z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22b%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m5.3125-4.6406-0.42188%202.1719c-0.10938%200.5625-0.25%201.2188-0.25%201.6719%200%200.3125%200.078125%200.51562%200.23438%200.51562%200.42188%200%200.53125-0.64062%200.65625-1.2812h0.34375c-0.15625%200.875-0.32812%201.6562-1.0625%201.6562-0.40625%200-0.64062-0.32812-0.64062-0.8125%200-0.10938%200-0.21875%200.03125-0.32812-0.45312%200.79688-1.1406%201.1406-2.0156%201.1406-0.70312%200-1.1719-0.54688-1.2188-1.25-0.015625%200.0625-0.015625%200.14062-0.015625%200.20312%200%200.71875%200.39062%202.1406%200.09375%202.6719-0.10938%200.20312-0.29688%200.29688-0.46875%200.29688-0.20312%200-0.35938-0.125-0.35938-0.32812%200-0.03125%200-0.0625%200.015625-0.09375l1.2031-6.2344h0.82812l-0.42188%202.1719c-0.078125%200.40625-0.125%200.78125-0.125%201.0938%200%200.67188%200.1875%201.0938%200.54688%201.0938%200.82812%200%201.5469-0.85938%201.7969-2.1875l0.42188-2.1719z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22a%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m1.2812-3.1719c0.15625-0.78125%200.59375-1.5625%201.2656-1.5625%200.5%200%200.75%200.4375%200.84375%200.90625%200.09375%200.34375%200.125%200.70312%200.125%201.0781%200%200.625-0.10938%201.2656-0.21875%201.9062%200.42188-0.40625%200.78125-0.89062%201.1094-1.3906%200.26562-0.375%200.51562-0.8125%200.51562-1.2031%200-0.09375-0.03125-0.1875-0.046875-0.28125-0.078125-0.1875-0.23438-0.32812-0.23438-0.54688%200-0.23438%200.20312-0.46875%200.42188-0.46875%200.42188%200%200.625%200.29688%200.625%200.73438%200%200.46875-0.25%201.0938-0.71875%201.6719-0.76562%200.9375-1.5312%201.8594-2.5156%202.5625l0.10938-0.54688c0.125-0.64062%200.20312-1.2812%200.20312-1.8906%200-0.48438-0.046875-0.96875-0.20312-1.4062-0.078125-0.23438-0.21875-0.4375-0.4375-0.4375-0.03125%200-0.078125%200.015625-0.10938%200.015625-0.3125%200.10938-0.39062%200.51562-0.45312%200.85938z%22/%3E%3C/symbol%3E%3CclipPath%20id%3D%22e%22%3E%3Cpath%20d%3D%22m0%200h11v10.332h-11z%22/%3E%3C/clipPath%3E%3CclipPath%20id%3D%22d%22%3E%3Cpath%20d%3D%22m11%200h12.883v7h-12.883z%22/%3E%3C/clipPath%3E%3C/defs%3E%3Cg%3E%3Cg%20clip-path%3D%22url%28%23e%29%22%3E%3Cg%3E%3Cuse%20x%3D%220.444%22%20y%3D%2210.233%22%20xlink%3Ahref%3D%22%23c%22/%3E%3C/g%3E%3C/g%3E%3Cg%20clip-path%3D%22url%28%23d%29%22%3E%3Cg%3E%3Cuse%20x%3D%2211.338%22%20y%3D%224.738%22%20xlink%3Ahref%3D%22%23b%22/%3E%3Cuse%20x%3D%2217.545166%22%20y%3D%224.738%22%20xlink%3Ahref%3D%22%23a%22/%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E"/> we can construct
a projector as</p>
<p><img alt="H = H^{\mu\nu} g_{\mu\nu} / (d-1)." class="display" style="vertical-align:-5.312234497070312pt" src="data:image/svg+xml,%3Csvg%20width%3D%22125.86pt%22%20height%3D%2215.955pt%22%20version%3D%221.1%22%20viewBox%3D%220%200%20125.86%2015.955%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%3E%3Cdefs%3E%3Csymbol%20id%3D%22c%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m1.1562-9.2344v0.51562l0.89062%200.078125%200.14062%200.20312-1.4688%207.6406-0.21875%200.1875-0.89062%200.09375v0.51562h3.3438v-0.51562l-0.875-0.09375-0.17188-0.1875%200.71875-3.7188h4.4844l-0.70312%203.7188-0.21875%200.1875-0.89062%200.09375v0.51562h3.3281v-0.51562l-0.875-0.09375-0.14062-0.1875%201.4688-7.6406%200.21875-0.20312%200.90625-0.078125v-0.51562h-3.3594v0.51562l0.875%200.078125%200.17188%200.20312-0.65625%203.2969h-4.4844l0.65625-3.2969%200.20312-0.20312%200.90625-0.078125v-0.51562z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22l%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m4.6406-6.2969c-0.42188-0.23438-0.84375-0.35938-1.2812-0.35938-1.5%200-2.6875%201.1719-2.6875%202.6719%200%200.73438%200.4375%201.3438%201.2656%201.6719-0.375%200.46875-0.54688%200.875-0.54688%201.3281%200%200.09375%200%200.15625%200.015625%200.23438-1.2344%200.48438-1.8281%201.0469-1.8281%201.9219%200%201.0938%200.98438%201.8281%202.5938%201.8281%201.9062%200%203.3281-1.0312%203.3281-2.0469%200-0.59375-0.35938-1.0312-1.0781-1.3594l-2.1875-1v-0.078125c0-0.26562%200.046875-0.5%200.17188-0.73438%200.1875%200.015625%200.29688%200.015625%200.3125%200.015625%201.4219%200%202.6562-1.0938%202.6562-2.5938%200-0.29688-0.0625-0.59375-0.1875-0.92188h1.4219v-0.57812zm-0.35938%201.4062c0%201.25-0.8125%202.2188-1.5938%202.2188-0.5625%200-0.92188-0.40625-0.92188-1.1562%200-1.2969%200.78125-2.3125%201.5781-2.3125%200.59375%200%200.9375%200.4375%200.9375%201.25zm-2.375%204.4219%201.75%200.8125c0.53125%200.23438%200.78125%200.53125%200.78125%200.875%200%200.625-0.73438%201.2031-1.9375%201.2031-1.0938%200-1.8594-0.64062-1.8594-1.5312%200-0.70312%200.45312-1.1719%201.2656-1.3594z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22k%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m6.5312-10.125-2.0938%200.39062v0.39062l1.2031%200.14062-0.48438%202.75c-0.35938-0.17188-0.71875-0.23438-1.0938-0.23438-1.1406%200-2.3594%200.6875-3.0938%201.8594-0.45312%200.70312-0.67188%201.5469-0.67188%202.4844%200%201.5781%200.6875%202.4688%201.7969%202.4688%200.73438%200%201.4688-0.42188%202.1406-1.2812-0.015625%200.09375-0.015625%200.1875-0.015625%200.28125%200%200.67188%200.29688%200.96875%200.92188%200.96875%200.35938%200%200.9375-0.125%201.7031-0.39062v-0.42188c-0.42188%200.09375-0.71875%200.15625-0.89062%200.15625-0.42188%200-0.60938-0.1875-0.60938-0.57812%200-0.1875%200.03125-0.4375%200.078125-0.75l1.4688-8.2344zm-2.2188%204.0156%200.65625%200.78125-0.625%203.5c-0.60938%200.78125-1.25%201.1719-1.75%201.1719-0.71875%200-1.1875-0.60938-1.1875-1.7031%200-2.2969%201.3281-3.7969%202.5781-3.7969%200.09375%200%200.20312%200.03125%200.32812%200.046875z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22j%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m0.76562-5.0312h9.25v-0.82812h-9.25zm0%202.9688h9.25v-0.82812h-9.25z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22i%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m1.9375-3.9688c0-3.7656%201.1094-5.6406%202.6875-5.9219v-0.625c-2.2812%200.28125-3.8594%202.3906-3.8594%206.5469s1.5781%206.2812%203.8594%206.5625v-0.64062c-1.5781-0.28125-2.6875-2.1406-2.6875-5.9219z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22h%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m3.4531-3.9688c0%203.7812-1.0938%205.6406-2.6875%205.9219v0.64062c2.2969-0.28125%203.8594-2.4062%203.8594-6.5625s-1.5625-6.2656-3.8594-6.5469v0.625c1.5938%200.28125%202.6875%202.1562%202.6875%205.9219z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22b%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m5.3125-4.6406-0.42188%202.1719c-0.10938%200.5625-0.25%201.2188-0.25%201.6719%200%200.3125%200.078125%200.51562%200.23438%200.51562%200.42188%200%200.53125-0.64062%200.65625-1.2812h0.34375c-0.15625%200.875-0.32812%201.6562-1.0625%201.6562-0.40625%200-0.64062-0.32812-0.64062-0.8125%200-0.10938%200-0.21875%200.03125-0.32812-0.45312%200.79688-1.1406%201.1406-2.0156%201.1406-0.70312%200-1.1719-0.54688-1.2188-1.25-0.015625%200.0625-0.015625%200.14062-0.015625%200.20312%200%200.71875%200.39062%202.1406%200.09375%202.6719-0.10938%200.20312-0.29688%200.29688-0.46875%200.29688-0.20312%200-0.35938-0.125-0.35938-0.32812%200-0.03125%200-0.0625%200.015625-0.09375l1.2031-6.2344h0.82812l-0.42188%202.1719c-0.078125%200.40625-0.125%200.78125-0.125%201.0938%200%200.67188%200.1875%201.0938%200.54688%201.0938%200.82812%200%201.5469-0.85938%201.7969-2.1875l0.42188-2.1719z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22a%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m1.2812-3.1719c0.15625-0.78125%200.59375-1.5625%201.2656-1.5625%200.5%200%200.75%200.4375%200.84375%200.90625%200.09375%200.34375%200.125%200.70312%200.125%201.0781%200%200.625-0.10938%201.2656-0.21875%201.9062%200.42188-0.40625%200.78125-0.89062%201.1094-1.3906%200.26562-0.375%200.51562-0.8125%200.51562-1.2031%200-0.09375-0.03125-0.1875-0.046875-0.28125-0.078125-0.1875-0.23438-0.32812-0.23438-0.54688%200-0.23438%200.20312-0.46875%200.42188-0.46875%200.42188%200%200.625%200.29688%200.625%200.73438%200%200.46875-0.25%201.0938-0.71875%201.6719-0.76562%200.9375-1.5312%201.8594-2.5156%202.5625l0.10938-0.54688c0.125-0.64062%200.20312-1.2812%200.20312-1.8906%200-0.48438-0.046875-0.96875-0.20312-1.4062-0.078125-0.23438-0.21875-0.4375-0.4375-0.4375-0.03125%200-0.078125%200.015625-0.10938%200.015625-0.3125%200.10938-0.39062%200.51562-0.45312%200.85938z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22g%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m6.1719-10.516h-0.875l-4.5312%2013.109h0.875z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22f%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m0.32812-3.5469h9.3594v-0.82812h-9.3594z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22e%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m4.2812-9.4062-2.9844%200.90625v0.57812l2.1562-0.39062v7.4062l-0.15625%200.23438-1.5938%200.078125v0.59375h4.6094v-0.57812l-1.4844-0.0625-0.15625-0.21875v-8.5469z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22d%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m1.9062-1.625c-0.46875%200-0.875%200.39062-0.875%200.875%200%200.5%200.40625%200.875%200.875%200.875%200.48438%200%200.875-0.39062%200.875-0.875s-0.39062-0.875-0.875-0.875z%22/%3E%3C/symbol%3E%3CclipPath%20id%3D%22m%22%3E%3Cpath%20d%3D%22m60%209h13v6.9531h-13z%22/%3E%3C/clipPath%3E%3C/defs%3E%3Cg%3E%3Cuse%20x%3D%220.444%22%20y%3D%2210.663%22%20xlink%3Ahref%3D%22%23c%22/%3E%3Cuse%20x%3D%2214.54%22%20y%3D%2210.663%22%20xlink%3Ahref%3D%22%23j%22/%3E%3Cuse%20x%3D%2228.925%22%20y%3D%2210.663%22%20xlink%3Ahref%3D%22%23c%22/%3E%3Cuse%20x%3D%2239.819%22%20y%3D%224.809%22%20xlink%3Ahref%3D%22%23b%22/%3E%3Cuse%20x%3D%2246.026166%22%20y%3D%224.809%22%20xlink%3Ahref%3D%22%23a%22/%3E%3Cuse%20x%3D%2253.296%22%20y%3D%2210.663%22%20xlink%3Ahref%3D%22%23l%22/%3E%3C/g%3E%3Cg%20clip-path%3D%22url%28%23m%29%22%3E%3Cg%3E%3Cuse%20x%3D%2260.265%22%20y%3D%2213.775%22%20xlink%3Ahref%3D%22%23b%22/%3E%3Cuse%20x%3D%2266.472166%22%20y%3D%2213.775%22%20xlink%3Ahref%3D%22%23a%22/%3E%3C/g%3E%3C/g%3E%3Cg%3E%3Cuse%20x%3D%2272.709%22%20y%3D%2210.663%22%20xlink%3Ahref%3D%22%23g%22/%3E%3Cuse%20x%3D%2279.677%22%20y%3D%2210.663%22%20xlink%3Ahref%3D%22%23i%22/%3E%3Cuse%20x%3D%2285.434%22%20y%3D%2210.663%22%20xlink%3Ahref%3D%22%23k%22/%3E%3Cuse%20x%3D%2296.232%22%20y%3D%2210.663%22%20xlink%3Ahref%3D%22%23f%22/%3E%3Cuse%20x%3D%22108.861%22%20y%3D%2210.663%22%20xlink%3Ahref%3D%22%23e%22/%3E%3Cuse%20x%3D%22116.519%22%20y%3D%2210.663%22%20xlink%3Ahref%3D%22%23h%22/%3E%3Cuse%20x%3D%22121.931%22%20y%3D%2210.663%22%20xlink%3Ahref%3D%22%23d%22/%3E%3C/g%3E%3C/svg%3E"/></p>
<p>Here it is in Mathematica notation.</p>
<pre><span class="tnv">projector</span> = <span class="tnv">delta</span>[<span class="tnv">lor</span>[-<span class="tl">1</span>], <span class="tnv">lor</span>[-<span class="tl">2</span>]] / (<span class="tnv">d</span>-<span class="tl">1</span>);</pre>
<p>Apply Feynman rules to get amplitudes out of diagrams.</p>
<pre><span class="tnv">amplitudes</span> = <span class="tnv">diagrams</span> // <a class="tnb" href="https://reference.wolfram.com/language/ref/Map.html" rel="nofollow">Map</a>[<a class="tnv" href="../alibrary.html#Amplitude">Amplitude</a>[<span class="tnv">#</span>] * <span class="tnv">projector</span>&amp;];</pre>
<h2 id="ZeroIntegralCleanup">Zero integral cleanup</h2>
<p>Cleanup scaleless integrals. Some of these show up as propagators
with zero momentum, which means that a part of the graph is
disconnected from the rest, and thus scaleless. We can set
these to zero immediately.</p>
<pre><span class="tnv">amplitudes2</span> = <span class="tnv">amplitudes</span> /. <span class="tnv">den</span>[<span class="tl">0</span>] -&gt; <span class="tl">0</span> /. <span class="tnv">momentum</span>[<span class="tl">0</span>,_] -&gt; <span class="tl">0</span>;
<a class="tnb" href="https://reference.wolfram.com/language/ref/Print.html" rel="nofollow">Print</a>[<span class="ts">"Non-zero amplitudes: "</span>, <span class="tnv">amplitudes2</span>//<a class="tnb" href="https://reference.wolfram.com/language/ref/Count.html" rel="nofollow">Count</a>[<a class="tnb" href="https://reference.wolfram.com/language/ref/Except.html" rel="nofollow">Except</a>[<span class="tl">0</span>]], <span class="ts">" of "</span>, <span class="tnv">amplitudes2</span>//<a class="tnb" href="https://reference.wolfram.com/language/ref/Length.html" rel="nofollow">Length</a>];</pre>
<p>In this particular example there is a set of diagrams that are
zero by the color factors. For example, those with subdiagrams
where a photon turns into a single gluon. In principle we
could try to skip these during diagram generation, but we
don’t need to. Lets compute color factors instead, and see
what turns to zero.</p>
<pre><span class="tnv">amplitudes3</span> = <span class="tnv">amplitudes2</span> // <a class="tnv" href="../alibrary.html#RunThroughForm">RunThroughForm</a>[{ <span class="ts">"#call colorsum\n"</span> }];
<a class="tnb" href="https://reference.wolfram.com/language/ref/Print.html" rel="nofollow">Print</a>[<span class="ts">"Non-zero amplitudes: "</span>, <span class="tnv">amplitudes3</span>//<a class="tnb" href="https://reference.wolfram.com/language/ref/Count.html" rel="nofollow">Count</a>[<a class="tnb" href="https://reference.wolfram.com/language/ref/Except.html" rel="nofollow">Except</a>[<span class="tl">0</span>]], <span class="ts">" of "</span>, <span class="tnv">amplitudes3</span>//<a class="tnb" href="https://reference.wolfram.com/language/ref/Length.html" rel="nofollow">Length</a>];</pre>
<h2 id="IntegralFamilyConstruction">Integral family construction</h2>
<p>Next we want to define the integral families onto which we
shall map the integrals, and which will be used in the IBP
reduction later.</p>
<p>To this end, start with the set of denominators per diagram.</p>
<pre><span class="tnv">loopMomenta</span> = <span class="tnv">diagrams</span> // <a class="tnv" href="../utils.html#CaseUnion">CaseUnion</a>[<span class="tnv">l1</span>|<span class="tnv">l2</span>|<span class="tnv">l3</span>|<span class="tnv">l4</span>|<span class="tnv">l5</span>];
<span class="tnv">externalMomenta</span> = <span class="tnv">diagrams</span> // <a class="tnv" href="../utils.html#CaseUnion">CaseUnion</a>[<span class="tnv">q</span>|<span class="tnv">q1</span>|<span class="tnv">q2</span>|<span class="tnv">q3</span>|<span class="tnv">q4</span>|<span class="tnv">q5</span>|<span class="tnv">p1</span>|<span class="tnv">p2</span>|<span class="tnv">p3</span>|<span class="tnv">p4</span>|<span class="tnv">p5</span>];
<a class="tnb" href="https://reference.wolfram.com/language/ref/Print.html" rel="nofollow">Print</a>[<span class="ts">"External momenta: "</span>, <span class="tnv">externalMomenta</span>];
<a class="tnb" href="https://reference.wolfram.com/language/ref/Print.html" rel="nofollow">Print</a>[<span class="ts">"Loop momenta: "</span>, <span class="tnv">loopMomenta</span>];
<a class="tnv" href="../utils.html#FailUnless">FailUnless</a>[<a class="tnb" href="https://reference.wolfram.com/language/ref/Length.html" rel="nofollow">Length</a>[<span class="tnv">loopMomenta</span>] === <span class="tnv">NLOOPS</span>];

<span class="tnv">denominatorSets</span> = <span class="tnv">amplitudes3</span> // <a class="tnv" href="../alibrary.html#NormalizeDens">NormalizeDens</a> // <a class="tnb" href="https://reference.wolfram.com/language/ref/Map.html" rel="nofollow">Map</a>[
  <a class="tnv" href="../utils.html#CaseUnion">CaseUnion</a>[<span class="tnt">_den</span>] /* <a class="tnb" href="https://reference.wolfram.com/language/ref/Select.html" rel="nofollow">Select</a>[<a class="tnv" href="../utils.html#NotFreeQ">NotFreeQ</a>[<a class="tnb" href="https://reference.wolfram.com/language/ref/Alternatives.html" rel="nofollow">Alternatives</a>@@<span class="tnv">loopMomenta</span>]]
];
<a class="tnb" href="https://reference.wolfram.com/language/ref/Print.html" rel="nofollow">Print</a>[<span class="ts">"Unique denominator sets: "</span>, <span class="tnv">denominatorSets</span> // <a class="tnb" href="https://reference.wolfram.com/language/ref/DeleteCases.html" rel="nofollow">DeleteCases</a>[{}] // <a class="tnb" href="https://reference.wolfram.com/language/ref/Union.html" rel="nofollow">Union</a> // <a class="tnb" href="https://reference.wolfram.com/language/ref/Length.html" rel="nofollow">Length</a>];</pre>
<p>In principle we could define the integral families by the
denominator sets above, one family per denominator set. This
is not very efficient though, as there are symmetries between
those families. It’s best to first eliminate denominator sets
that are symmetric to others.</p>
<p>The symmetries manifest most directly in the Feynman parameter
space, as permutations of the parameters. In the momenta space
this corresponds to loop momenta shifts, and we would like
to have a set of momenta shifts that would make symmetric
families explicitly identical, or identical to subsets of
bigger families, so we could test if a family is symmetric by
just asking if the set of denominators a subset of another
family.</p>
<p>The tool to compute this momenta mapping is <a href="https://github.com/magv/feynson">Feynson</a>, and
the interface to it is <a href="../alibrary.html#SymmetryMaps">SymmetryMaps</a>.</p>
<pre><span class="tnv">$Feynson</span> = <span class="ts">"feynson"</span>;
<span class="tnv">momentaMaps</span> = <a class="tnv" href="../alibrary.html#SymmetryMaps">SymmetryMaps</a>[<span class="tnv">denominatorSets</span>, <span class="tnv">loopMomenta</span>];
<a class="tnb" href="https://reference.wolfram.com/language/ref/Print.html" rel="nofollow">Print</a>[<span class="ts">"Found "</span>, <span class="tnv">momentaMaps</span> // <a class="tnb" href="https://reference.wolfram.com/language/ref/DeleteCases.html" rel="nofollow">DeleteCases</a>[{}] // <a class="tnb" href="https://reference.wolfram.com/language/ref/Length.html" rel="nofollow">Length</a>, <span class="ts">" momenta mappings"</span>];

<span class="tnv">symmetrizedDenominatorSets</span> =
  <a class="tnb" href="https://reference.wolfram.com/language/ref/MapThread.html" rel="nofollow">MapThread</a>[<a class="tnb" href="https://reference.wolfram.com/language/ref/ReplaceAll.html" rel="nofollow">ReplaceAll</a>, {<span class="tnv">denominatorSets</span>, <span class="tnv">momentaMaps</span>}] //
  <a class="tnv" href="../alibrary.html#NormalizeDens">NormalizeDens</a>;</pre>
<p>Then, the set of unique supersets of the denominator sets is
the set of integral families we need.</p>
<pre>{<span class="tnv">denominatorSupersets</span>, <span class="tnv">supersetIndices</span>} =
  <a class="tnv" href="../library.html#UniqueSupertopologyMapping">UniqueSupertopologyMapping</a>[<span class="tnv">symmetrizedDenominatorSets</span>];
<a class="tnb" href="https://reference.wolfram.com/language/ref/Print.html" rel="nofollow">Print</a>[<span class="ts">"Total integral families: "</span>, <span class="tnv">denominatorSupersets</span>//<a class="tnb" href="https://reference.wolfram.com/language/ref/Length.html" rel="nofollow">Length</a>];</pre>
<p>Let us then construct the IBP basis objects for each unique
denominator superset. These objects are just associations
storing denominators, and maps from scalar products into the
denominators.</p>
<p>Also in the case when the denominator set is not sufficient
to form the full linear basis of scalar products, we want to
complete it; <a href="../alibrary.html#CompleteIBPBasis">CompleteIBPBasis</a> will do this for us.</p>
<pre><span class="tnv">bases</span> = <span class="tnv">denominatorSupersets</span> //
  <a class="tnb" href="https://reference.wolfram.com/language/ref/MapIndexed.html" rel="nofollow">MapIndexed</a>[<a class="tnv" href="../alibrary.html#CompleteIBPBasis">CompleteIBPBasis</a>[
    <a class="tnb" href="https://reference.wolfram.com/language/ref/First.html" rel="nofollow">First</a>[<span class="tnv">#2</span>], <span class="tnv">#1</span> // <a class="tnv" href="../alibrary.html#NormalizeDens">NormalizeDens</a> // <a class="tnb" href="https://reference.wolfram.com/language/ref/Sort.html" rel="nofollow">Sort</a>, <span class="tnv">loopMomenta</span>, <span class="tnv">externalMomenta</span>, {<span class="tnv">sp</span>[<span class="tnv">q</span>,<span class="tnv">q</span>]-&gt;<span class="tnv">sqrq</span>}
  ]&amp;];</pre>
<h2 id="AmplitudeConversion">Amplitude conversion</h2>
<p>OK, now that we have the IBP bases, we can convert the
amplitudes to them.</p>
<p>One practical thing to start with is to identify the set of
sectors (integral family subsets) that correspond to scaleless
integrals. This is also done with <a href="https://github.com/magv/feynson">Feynson</a>.</p>
<pre><span class="tnv">zeroSectors</span> = <a class="tnv" href="../alibrary.html#ZeroSectors">ZeroSectors</a>[<span class="tnv">bases</span>];</pre>
<p>Next, just call FORM to do all the tensor summation and
conversion to IBP families.</p>
<pre><span class="tnv">amplitudesB</span> =
  <a class="tnb" href="https://reference.wolfram.com/language/ref/MapThread.html" rel="nofollow">MapThread</a>[<a class="tnb" href="https://reference.wolfram.com/language/ref/ReplaceAll.html" rel="nofollow">ReplaceAll</a>, {<span class="tnv">amplitudes3</span>, <span class="tnv">momentaMaps</span>}] //
  <span class="tnv">#</span> * <span class="tnv">BID</span>^<span class="tnv">supersetIndices</span> &amp; //
  <a class="tnv" href="../alibrary.html#RunThroughForm">RunThroughForm</a>[{
    <span class="ts">"#call contractmomenta\n"</span>,
    <span class="ts">"#call sort(after-contractmomenta)\n"</span>,
    <span class="ts">"#call chaincolorT\n"</span>,
    <span class="ts">"#call chaingammachain\n"</span>,
    <span class="ts">"#call flavorsumwithcharge\n"</span>,
    <span class="ts">"#call colorsum\n"</span>,
    <span class="ts">"#call sort(after-colorsum)\n"</span>,
    <span class="ts">"#call polarizationsum\n"</span>,
    <span class="ts">"#call spinsum\n"</span>,
    <span class="ts">"#call diractrace\n"</span>,
    <span class="ts">"#call contractmomenta\n"</span>,
    <a class="tnv" href="../alibrary.html#FormCallToB">FormCallToB</a>[<span class="tnv">bases</span>],
    <span class="ts">"id mt1^2 = mt2;\n"</span>,
    <span class="tnv">FormCallZeroSectors</span>[<span class="tnv">zeroSectors</span>]
  }] //
  <a class="tnv" href="../utils.html#MapWithProgress">MapWithProgress</a>[<a class="tnv" href="../library.html#FasterFactor">FasterFactor</a>];

<a class="tnv" href="../utils.html#FailUnless">FailUnless</a>[<a class="tnb" href="https://reference.wolfram.com/language/ref/FreeQ.html" rel="nofollow">FreeQ</a>[<span class="tnv">amplitudesB</span>, <span class="tnv">l1</span>|<span class="tnv">l2</span>|<span class="tnv">l3</span>|<span class="tnv">l4</span>]];</pre>
<h2 id="IbpReduction">IBP reduction</h2>
<p>Next, lets do the IBP reduction.</p>
<p>We’ll use <a href="../alibrary.html#KiraIBP">KiraIBP</a>, a simple interface to IBP with <a href="https://kira.hepforge.org/">Kira</a>.
It is probably too simplistic to work automatically for larger
examples, but for this problem it’s ideal.</p>
<p>Note that for best performance IBP reduction should be
performed with one of the mass scales set to <code>1</code>. This is
possible because we can always restore the overall power of
that mass scale by dimensional analysys at the end of the
calculation.</p>
<p>For this reason, we will instruct Kira to set <code>mt2</code> to <code>1</code>,
and will do the same replacement in the rest of the amplitude
ourselves.</p>
<pre><span class="tnv">amplitudesBibp</span> = <span class="tnv">amplitudesB</span> //
  <a class="tnb" href="https://reference.wolfram.com/language/ref/ReplaceAll.html" rel="nofollow">ReplaceAll</a>[<span class="tnv">mt2</span> -&gt; <span class="tl">1</span>] //
  <a class="tnv" href="../alibrary.html#KiraIBP">KiraIBP</a>[<span class="tnv">bases</span>, <span class="tnv">ReplaceByOne</span>-&gt;<span class="tnv">mt2</span>];</pre>
<p>The full amplitude is just the sum of the diagram amplitudes.</p>
<pre><span class="tnv">fullAmplitude</span> = <span class="tnv">amplitudesBibp</span> // <a class="tnb" href="https://reference.wolfram.com/language/ref/Apply.html" rel="nofollow">Apply</a>[<a class="tnb" href="https://reference.wolfram.com/language/ref/Plus.html" rel="nofollow">Plus</a>] // <a class="tnv" href="../utils.html#Bracket">Bracket</a>[<span class="tnv">#</span>, <span class="tnt">_B</span>, <a class="tnb" href="https://reference.wolfram.com/language/ref/Factor.html" rel="nofollow">Factor</a>]&amp;;</pre>
<p>A good correctness check is to see if the result is
gauge-independent. Because our <a href="../amodel-qcd.html#QcdFeynmanRules">QCD Feynman rules</a> use the
<img alt="R_\xi" style="vertical-align:-5.105844116210937pt" src="data:image/svg+xml,%3Csvg%20width%3D%2215.167pt%22%20height%3D%2214.469pt%22%20version%3D%221.1%22%20viewBox%3D%220%200%2015.167%2014.469%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%3E%3Cdefs%3E%3Csymbol%20id%3D%22b%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m1.0469-9.2344v0.51562l0.98438%200.09375%200.14062%200.1875-1.4688%207.6562-0.21875%200.1875-0.89062%200.078125v0.51562h3.3594v-0.51562l-0.89062-0.078125-0.15625-0.1875%200.64062-3.3125c0.28125-0.015625%200.53125-0.015625%200.75-0.015625%200.375%200%200.64062%200.015625%200.8125%200.10938%200.6875%200.3125%200.78125%200.85938%200.95312%201.6562%200.20312%200.9375%200.32812%201.6562%200.82812%202.0625%200.26562%200.21875%200.6875%200.34375%201.2656%200.34375%200.21875%200%200.53125-0.015625%200.96875-0.078125v-0.5h-0.125c-1.0625%200-1.3281-0.35938-1.6094-1.3906-0.375-1.2969-0.48438-2.2031-1.7031-2.4531%201.7656-0.39062%202.75-1.4688%202.75-2.875s-0.95312-2-2.9062-2zm1.625%204.4844%200.73438-3.8438c0.21875-0.015625%200.40625-0.03125%200.57812-0.03125%201.4531%200%202.1406%200.5%202.1406%201.6094%200%201.4062-1.0312%202.2812-2.9375%202.2812-0.17188%200-0.34375%200-0.51562-0.015625z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22a%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m3.8594-4.125c-0.015625-0.015625-0.046875-0.03125-0.078125-0.03125-0.015625%200-0.03125%200-0.046875%200.015625-0.29688%200-0.60938%200.03125-0.89062%200.10938-0.48438-0.015625-0.84375-0.1875-0.84375-0.5625%200-0.03125%200.015625-0.078125%200.015625-0.125%200.21875-1.1406%201.6875-1.2031%202.8906-1.5312%200.20312-0.0625%200.32812-0.21875%200.35938-0.375v-0.0625c0-0.17188-0.10938-0.32812-0.29688-0.32812-0.046875%200-0.078125%200-0.125%200.015625-0.625%200.15625-1.2656%200.35938-1.8281%200.65625h-0.1875c-0.3125%200-0.51562-0.078125-0.51562-0.29688%200-0.03125%200-0.046875%200.015625-0.078125v-0.078125c0-0.14062-0.10938-0.21875-0.25-0.21875s-0.29688%200.10938-0.32812%200.29688c-0.015625%200.078125-0.03125%200.14062-0.03125%200.20312%200%200.35938%200.26562%200.53125%200.6875%200.54688-0.39062%200.3125-0.67188%200.70312-0.76562%201.1875-0.015625%200.0625-0.03125%200.14062-0.03125%200.1875%200%200.39062%200.25%200.64062%200.625%200.78125-0.76562%200.35938-1.3906%200.98438-1.5312%201.7812-0.03125%200.14062-0.046875%200.26562-0.046875%200.39062%200%201%200.76562%201.7344%201.8281%201.7344%200.39062%200%200.76562-0.046875%201.1406-0.046875%200.28125%200%200.46875%200.21875%200.46875%200.48438%200%200.03125-0.015625%200.078125-0.015625%200.125-0.078125%200.40625-0.51562%200.64062-0.98438%200.64062-0.17188%200-0.34375-0.03125-0.51562-0.09375-0.03125-0.015625-0.0625-0.015625-0.09375-0.015625-0.17188%200-0.32812%200.17188-0.35938%200.34375v0.0625c0%200.14062%200.09375%200.26562%200.32812%200.26562%200.89062%200%201.8594-0.42188%202.0156-1.2031%200.015625-0.10938%200.03125-0.1875%200.03125-0.28125%200-0.60938-0.42188-1.0781-1.0625-1.0781-0.29688%200-0.59375-0.03125-0.90625-0.03125-0.79688%200-1.4531-0.4375-1.4531-1.125%200-0.078125%200-0.14062%200.015625-0.21875%200.20312-0.98438%201.4531-1.3281%202.5938-1.3281%200.20312%200%200.34375-0.17188%200.375-0.35938%200.015625-0.015625%200.015625-0.046875%200.015625-0.0625%200-0.14062-0.0625-0.25-0.21875-0.29688z%22/%3E%3C/symbol%3E%3CclipPath%20id%3D%22c%22%3E%3Cpath%20d%3D%22m9%205h6v9.4688h-6z%22/%3E%3C/clipPath%3E%3C/defs%3E%3Cg%3E%3Cuse%20x%3D%220.1%22%20y%3D%229.382%22%20xlink%3Ahref%3D%22%23b%22/%3E%3C/g%3E%3Cg%20clip-path%3D%22url%28%23c%29%22%3E%3Cg%3E%3Cuse%20x%3D%228.735%22%20y%3D%2212.495%22%20xlink%3Ahref%3D%22%23a%22/%3E%3C/g%3E%3C/g%3E%3C/svg%3E"/> gauge and set <code>Xi</code>=<img alt="\xi-1" style="vertical-align:-2.8095184326171876pt" src="data:image/svg+xml,%3Csvg%20width%3D%2231.449pt%22%20height%3D%2213.076pt%22%20version%3D%221.1%22%20viewBox%3D%220%200%2031.449%2013.076%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%3E%3Cdefs%3E%3Csymbol%20id%3D%22c%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m5.5625-5.9531c-0.03125%200-0.0625-0.015625-0.125-0.015625-0.015625%200-0.046875%200-0.0625%200.015625-0.4375%200-0.875%200.046875-1.2812%200.15625-0.70312-0.03125-1.2188-0.28125-1.2188-0.8125%200-0.046875%200.015625-0.125%200.03125-0.1875%200.29688-1.625%202.4219-1.7344%204.1562-2.2031%200.29688-0.078125%200.46875-0.3125%200.51562-0.53125v-0.10938c0-0.25-0.14062-0.46875-0.4375-0.46875-0.046875%200-0.10938%200.015625-0.17188%200.03125-0.89062%200.23438-1.8281%200.53125-2.625%200.9375-0.09375%200-0.1875%200.015625-0.28125%200.015625-0.4375%200-0.73438-0.125-0.73438-0.42188%200-0.046875%200-0.09375%200.015625-0.125v-0.10938c0-0.20312-0.15625-0.3125-0.34375-0.3125-0.20312%200-0.4375%200.14062-0.48438%200.42188-0.03125%200.10938-0.03125%200.20312-0.03125%200.28125%200%200.54688%200.375%200.76562%200.98438%200.79688-0.5625%200.45312-0.98438%201.0156-1.1094%201.7188-0.015625%200.09375-0.03125%200.1875-0.03125%200.26562%200%200.54688%200.35938%200.92188%200.89062%201.125-1.1094%200.51562-2%201.4219-2.2188%202.5625-0.015625%200.20312-0.046875%200.39062-0.046875%200.5625%200%201.4375%201.0938%202.4844%202.625%202.4844%200.54688%200%201.1094-0.0625%201.6406-0.0625%200.39062%200%200.67188%200.3125%200.67188%200.6875%200%200.0625-0.015625%200.125-0.015625%200.1875-0.125%200.59375-0.75%200.9375-1.4219%200.9375-0.25%200-0.5-0.046875-0.73438-0.14062-0.0625-0.015625-0.09375-0.03125-0.15625-0.03125-0.23438%200-0.45312%200.25-0.5%200.5v0.09375c0%200.20312%200.125%200.39062%200.46875%200.39062%201.2812%200%202.6719-0.60938%202.8906-1.75%200.03125-0.14062%200.046875-0.26562%200.046875-0.40625%200-0.875-0.60938-1.5469-1.5312-1.5469-0.42188%200-0.84375-0.046875-1.2969-0.046875-1.1406%200-2.0781-0.60938-2.0781-1.6094%200-0.10938%200-0.20312%200.015625-0.3125%200.28125-1.4375%202.0938-1.9375%203.7344-1.9375%200.29688%200%200.5-0.23438%200.53125-0.48438%200.015625-0.046875%200.015625-0.09375%200.015625-0.10938%200-0.20312-0.078125-0.35938-0.29688-0.4375z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22b%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m0.32812-3.5469h9.3594v-0.82812h-9.3594z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22a%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m4.2812-9.4062-2.9844%200.90625v0.57812l2.1562-0.39062v7.4062l-0.15625%200.23438-1.5938%200.078125v0.59375h4.6094v-0.57812l-1.4844-0.0625-0.15625-0.21875v-8.5469z%22/%3E%3C/symbol%3E%3C/defs%3E%3Cg%3E%3Cuse%20x%3D%220.1%22%20y%3D%2210.277%22%20xlink%3Ahref%3D%22%23c%22/%3E%3Cuse%20x%3D%2211.062%22%20y%3D%2210.277%22%20xlink%3Ahref%3D%22%23b%22/%3E%3Cuse%20x%3D%2223.692%22%20y%3D%2210.277%22%20xlink%3Ahref%3D%22%23a%22/%3E%3C/g%3E%3C/svg%3E"/>, we can check if there is
any <code>Xi</code> dependence left: none should remain.</p>
<pre><a class="tnv" href="../utils.html#FailUnless">FailUnless</a>[<a class="tnb" href="https://reference.wolfram.com/language/ref/FreeQ.html" rel="nofollow">FreeQ</a>[<span class="tnv">fullAmplitude</span>, <span class="tnv">Xi</span>]];</pre>
<p>We now have the amplitude reduced to master integrals.</p>
<pre><a class="tnb" href="https://reference.wolfram.com/language/ref/Print.html" rel="nofollow">Print</a>[<span class="ts">"Master integral count: "</span>, <span class="tnv">fullAmplitude</span> // <a class="tnv" href="../utils.html#CaseUnion">CaseUnion</a>[<span class="tnt">_B</span>] // <a class="tnb" href="https://reference.wolfram.com/language/ref/Length.html" rel="nofollow">Length</a>];</pre>
<h2 id="NumericalEvaluation">Numerical evaluation</h2>
<p>The final step is to insert the values of the masters. Of
course the masters here are known analytically, but as an
example let us evaluate them numerically with <a href="https://github.com/gudrunhe/secdec">pySecDec</a>.</p>
<p>Although pySecDec was originally designed to evaluate single
integrals, there are optimizations that can be performed when
evaluating whole amplitudes, and pySecDec knows how to apply
those. This is why our strategy will be to give pySecDec the
whole <code>fullAmplitude</code>, and ask to evaluate it, instead of
asking for each integral separately.</p>
<p>To this end, let’s inspect the variables our amplitude depends
on:</p>
<pre><a class="tnb" href="https://reference.wolfram.com/language/ref/Print.html" rel="nofollow">Print</a>[<span class="ts">"Variables in the amplitude: "</span>, <span class="tnv">fullAmplitude</span> // <a class="tnv" href="../utils.html#CaseUnion">CaseUnion</a>[<span class="tnt">_Symbol</span>]];
<a class="tnb" href="https://reference.wolfram.com/language/ref/Print.html" rel="nofollow">Print</a>[<span class="ts">"Functions in the amplitude: "</span>, <span class="tnv">fullAmplitude</span> // <a class="tnv" href="../utils.html#CaseUnion">CaseUnion</a>[(<span class="tnt">h_</span>)[___]:&gt;<span class="tnv">h</span>]];</pre>
<p>Variables like number of quark flavours and SU(N) constants
can be set to numbers to evaluate <code>fullAmplitude</code> as a single
numerical value, but because the master integrals themselves
do not depend on these variables, we can factor them out and
split <code>fullAmplitude</code> into a sum of prefactors (that we will
keep symbolically) multiplied by sums of integrals (that we
will evaluate numerically).</p>
<pre><span class="tnv">fullAmplitudeByPrefactor</span> = <span class="tnv">fullAmplitude</span> //
  <a class="tnb" href="https://reference.wolfram.com/language/ref/ReplaceAll.html" rel="nofollow">ReplaceAll</a>[<a class="tnb" href="https://reference.wolfram.com/language/ref/Complex.html" rel="nofollow">Complex</a>[<span class="tnt">re_</span>, <span class="tnt">im_</span>] :&gt; <span class="tnv">re</span> + <span class="tnv">im</span>*<span class="tnv">ImagI</span>] //
  <a class="tnv" href="../utils.html#BracketAssociation">BracketAssociation</a>[<span class="tnv">Ca</span> | <span class="tnv">Cf</span> | <span class="tnv">Na</span> | <span class="tnv">Tf</span> | <span class="tnv">d33</span> | <span class="tnv">d44</span> | <span class="tnv">Nc</span> | <span class="tnv">Nf</span> | <span class="tnv">Nft</span> | <span class="tnv">gH</span> | <span class="tnv">gs</span> | <span class="tnv">Xi</span> | <span class="tnv">ImagI</span> | <span class="tnt">_flvsum</span> | <span class="tnt">_flvsumt</span>];

<a class="tnb" href="https://reference.wolfram.com/language/ref/Print.html" rel="nofollow">Print</a>[<span class="ts">"Symbolic prefactors:"</span>];
<span class="tnv">fullAmplitudeByPrefactor</span> // <a class="tnb" href="https://reference.wolfram.com/language/ref/Keys.html" rel="nofollow">Keys</a> // <a class="tnv" href="../utils.html#PrintIndexed">PrintIndexed</a>;</pre>
<p>Now we are ready to prepare the pySecDec integration library.
Let us ask pySecDec to expand the amplitudes to order
<img alt="\mathcal{O}(\varepsilon^2)" style="vertical-align:-2.7127471923828126pt" src="data:image/svg+xml,%3Csvg%20width%3D%2235.158pt%22%20height%3D%2214.863pt%22%20version%3D%221.1%22%20viewBox%3D%220%200%2035.158%2014.863%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%3E%3Cdefs%3E%3Csymbol%20id%3D%22e%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m9.2031-6.4688c-0.046875%200.0625-0.0625%200.125-0.0625%200.17188%200%200.10938%200.078125%200.14062%200.1875%200.14062%200.15625%200%200.375-0.09375%200.5-0.3125%200.28125-0.48438%200.40625-0.9375%200.40625-1.3438%200-0.89062-0.67188-1.5-1.8438-1.5-2.125%200-4.8281%201.6875-6.0156%203.7656-0.70312%201.2031-1.0312%202.3125-1.0312%203.2188%200%201.4531%200.84375%202.3906%202.4062%202.3906%201.4844%200%203.4219-1.2656%204.3281-2.8281%200.73438-1.2656%201.0938-2.4062%201.0938-3.2812%200-0.96875-0.45312-1.5781-1.3594-1.5781-1.375%200-3.25%201.3438-4.2188%203-0.65625%201.1562-0.79688%202.2188-0.79688%203.2031%200%200.125%200.0625%200.17188%200.15625%200.17188%200.23438%200%200.57812-0.21875%200.57812-0.48438%200-0.89062%200.10938-1.8438%200.6875-2.8906%200.8125-1.3906%202.2969-2.5156%203.3125-2.5156%200.42188%200%200.625%200.3125%200.625%200.85938%200%200.79688-0.4375%202.0781-1.2656%203.5156-0.73438%201.2969-2.0312%202.3594-2.8594%202.3594-0.96875%200-1.4688-0.67188-1.4688-1.7188%200-0.90625%200.375-2.0938%201.125-3.4219%201.0469-1.7969%203.0312-3.2812%204.4219-3.2812%200.92188%200%201.4375%200.5%201.4375%201.2188%200%200.34375-0.10938%200.73438-0.34375%201.1406z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22d%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m1.9375-3.9688c0-3.7656%201.1094-5.6406%202.6875-5.9219v-0.625c-2.2812%200.28125-3.8594%202.3906-3.8594%206.5469s1.5781%206.2812%203.8594%206.5625v-0.64062c-1.5781-0.28125-2.6875-2.1406-2.6875-5.9219z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22c%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m3.4531-3.9688c0%203.7812-1.0938%205.6406-2.6875%205.9219v0.64062c2.2969-0.28125%203.8594-2.4062%203.8594-6.5625s-1.5625-6.2656-3.8594-6.5469v0.625c1.5938%200.28125%202.6875%202.1562%202.6875%205.9219z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22b%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m5.1719-1.8125c-0.39062%200.82812-1.2812%201.4062-2.1406%201.4062-0.70312%200-1.1094-0.42188-1.1094-1.0781%200-0.10938%200-0.23438%200.03125-0.35938%200.14062-0.71875%200.65625-1.2031%201.2812-1.2031%200.32812%200%200.53125%200.32812%200.875%200.32812%200.45312%200%200.73438-0.40625%200.73438-0.76562%200-0.25-0.15625-0.48438-0.5-0.48438s-0.65625%200.3125-1%200.3125c-0.45312%200-0.73438-0.3125-0.73438-0.79688%200-0.09375%200.015625-0.20312%200.03125-0.3125%200.17188-0.8125%200.75-1.3281%201.4844-1.3281%201.3125%200%200.70312%201.3281%201.4844%201.3281%200.32812%200%200.625-0.26562%200.6875-0.59375%200.015625-0.0625%200.015625-0.14062%200.015625-0.20312%200-0.8125-1.0312-1.0781-2.0781-1.0781-1.3906%200-2.5469%200.84375-2.7812%202.0469v0.23438c0%200.54688%200.35938%200.95312%200.92188%201.0156-0.79688%200.20312-1.4531%200.875-1.6094%201.6719-0.015625%200.09375-0.015625%200.1875-0.015625%200.28125%200%200.89062%200.84375%201.5156%202.1875%201.5156%201.0156%200%202.0469-0.625%202.6094-1.5781z%22/%3E%3C/symbol%3E%3Csymbol%20id%3D%22a%22%20overflow%3D%22visible%22%3E%3Cpath%20d%3D%22m1.3438-0.75c2.125-1.6875%203.2812-2.7656%203.2812-3.9688%200-1.0781-0.76562-1.8125-2-1.8125-1.1875%200-2.0156%200.67188-2.0156%201.3438%200%200.32812%200.1875%200.54688%200.53125%200.54688%200.15625%200%200.29688-0.046875%200.42188-0.15625v-1.0156c0.29688-0.15625%200.5625-0.23438%200.85938-0.23438%200.79688%200%201.2656%200.53125%201.2656%201.4531%200%201.25-1.1875%202.2969-3.2812%203.9844v0.60938h4.4219v-1.5625h-0.42188l-0.17188%200.8125z%22/%3E%3C/symbol%3E%3CclipPath%20id%3D%22g%22%3E%3Cpath%20d%3D%22m11%201h5v13.863h-5z%22/%3E%3C/clipPath%3E%3CclipPath%20id%3D%22f%22%3E%3Cpath%20d%3D%22m30%201h5v13.863h-5z%22/%3E%3C/clipPath%3E%3C/defs%3E%3Cg%3E%3Cuse%20x%3D%220.1%22%20y%3D%2212.16%22%20xlink%3Ahref%3D%22%23e%22/%3E%3C/g%3E%3Cg%20clip-path%3D%22url%28%23g%29%22%3E%3Cg%3E%3Cuse%20x%3D%2211.186%22%20y%3D%2212.16%22%20xlink%3Ahref%3D%22%23d%22/%3E%3C/g%3E%3C/g%3E%3Cg%3E%3Cuse%20x%3D%2216.599%22%20y%3D%2212.16%22%20xlink%3Ahref%3D%22%23b%22/%3E%3Cuse%20x%3D%2223.83%22%20y%3D%226.665%22%20xlink%3Ahref%3D%22%23a%22/%3E%3C/g%3E%3Cg%20clip-path%3D%22url%28%23f%29%22%3E%3Cg%3E%3Cuse%20x%3D%2229.645%22%20y%3D%2212.16%22%20xlink%3Ahref%3D%22%23c%22/%3E%3C/g%3E%3C/g%3E%3C/svg%3E"/>.</p>
<pre><span class="tnv">basesWithoutMt2</span> = <span class="tnv">bases</span> // <a class="tnb" href="https://reference.wolfram.com/language/ref/Map.html" rel="nofollow">Map</a>[
  (<a class="tnb" href="https://reference.wolfram.com/language/ref/Append.html" rel="nofollow">Append</a>[<span class="tnv">#</span>, &lt;|<span class="ts">"invariants"</span> -&gt; <a class="tnb" href="https://reference.wolfram.com/language/ref/DeleteCases.html" rel="nofollow">DeleteCases</a>[<span class="tnv">#</span>[<span class="ts">"invariants"</span>], <span class="tnv">mt2</span>]|&gt;]&amp;) /*
  <a class="tnb" href="https://reference.wolfram.com/language/ref/Map.html" rel="nofollow">Map</a>[<a class="tnb" href="https://reference.wolfram.com/language/ref/ReplaceAll.html" rel="nofollow">ReplaceAll</a>[<span class="tnv">mt2</span> -&gt; <span class="tl">1</span>]]
];

<a class="tnv" href="../alibrary.html#SecDecPrepareSum">SecDecPrepareSum</a>[
  <span class="ts">"secdectmpdir"</span>,
  <span class="tnv">basesWithoutMt2</span>,
  <span class="tnv">fullAmplitudeByPrefactor</span> // <a class="tnb" href="https://reference.wolfram.com/language/ref/KeyMap.html" rel="nofollow">KeyMap</a>[<a class="tnb" href="https://reference.wolfram.com/language/ref/InputForm.html" rel="nofollow">InputForm</a>/*<a class="tnb" href="https://reference.wolfram.com/language/ref/ToString.html" rel="nofollow">ToString</a>] // <a class="tnb" href="https://reference.wolfram.com/language/ref/Map.html" rel="nofollow">Map</a>[<a class="tnb" href="https://reference.wolfram.com/language/ref/ReplaceAll.html" rel="nofollow">ReplaceAll</a>[<span class="tnv">d</span>-&gt;<span class="tl">4</span>-<span class="tl">2</span>*<span class="tnv">eps</span>]],
  <a class="tnb" href="https://reference.wolfram.com/language/ref/Order.html" rel="nofollow">Order</a>-&gt;<span class="tl">2</span>];</pre>
<p>After the library is prepared, it needs to be compiled. This
is done by just running the <code>compile.py</code> script inside:</p>
<pre><a class="tnv" href="../utils.html#SafeRun">SafeRun</a>[<span class="ts">"python3 secdectmpdir/compile.py"</span>];</pre>
<p>The compilation here automatically runs in parallel, but it
might still take a while. Once it is done, we are ready for
integration.</p>
<p>Once we have selected some values for the parameters,
we can integrate via <a href="../alibrary.html#SecDecIntegrateSum">SecDecIntegrateSum</a>:</p>
<pre><span class="tnv">pspoint</span> = { <span class="tnv">sqrq</span> -&gt; <span class="tl">120</span>/<span class="tl">100</span> };

<span class="tnv">result</span> = <a class="tnv" href="../alibrary.html#SecDecIntegrateSum">SecDecIntegrateSum</a>[
  <span class="ts">"secdectmpdir/disteval/sum.json"</span>,
  <span class="tnv">pspoint</span>,
  <span class="tnv">EpsRel</span> -&gt; <span class="tl">10</span>^-<span class="tl">3</span>, 
  <span class="tnv">EpsAbs</span> -&gt; <span class="tl">10</span>^-<span class="tl">8</span>];</pre>
<p>The integration will automatically run in parallel using all
locally available processors. It can also use the local GPUs,
although for this we would have needed to build the separate
GPU integration libraries during compilation (by setting
the <code>SECDEC_WITH_CUDA_FLAGS</code> environment variable to e.g.
<code>-gencode arch=compute_80,code=sm_80</code>, if GPUs with CUDA
“Compute Capability” 8.0 are used).</p>
<p>Once the integration is over, all that is left for us is to
read out the results:</p>
<pre><a class="tnb" href="https://reference.wolfram.com/language/ref/Print.html" rel="nofollow">Print</a>[<span class="ts">"Amplitude"</span>, <span class="tnv">pspoint</span> // <a class="tnb" href="https://reference.wolfram.com/language/ref/InputForm.html" rel="nofollow">InputForm</a>, <span class="ts">"="</span>]
<span class="tnv">symbolicPrefactors</span> = <span class="tnv">result</span>[<span class="ts">"sums"</span>] // <a class="tnb" href="https://reference.wolfram.com/language/ref/Keys.html" rel="nofollow">Keys</a>;
<a class="tnb" href="https://reference.wolfram.com/language/ref/Do.html" rel="nofollow">Do</a>[
  <a class="tnb" href="https://reference.wolfram.com/language/ref/Print.html" rel="nofollow">Print</a>[<span class="ts">"  +"</span>, <span class="tnv">prefactor</span>, <span class="ts">" * ("</span>];
  <span class="tnv">result</span>[<span class="ts">"sums"</span>][<span class="tnv">prefactor</span>] // <a class="tnb" href="https://reference.wolfram.com/language/ref/Map.html" rel="nofollow">Map</a>[<a class="tnb" href="https://reference.wolfram.com/language/ref/Replace.html" rel="nofollow">Replace</a>[
    {<span class="tnt">regulators_</span>, <span class="tnt">value_</span>, <span class="tnt">error_</span>} :&gt; (
      <a class="tnb" href="https://reference.wolfram.com/language/ref/Print.html" rel="nofollow">Print</a>[<span class="ts">"    +"</span>, <span class="tnv">regulators</span> // <a class="tnb" href="https://reference.wolfram.com/language/ref/InputForm.html" rel="nofollow">InputForm</a>, <span class="ts">"*("</span>];
      <a class="tnb" href="https://reference.wolfram.com/language/ref/Print.html" rel="nofollow">Print</a>[<span class="ts">"       ("</span>, <span class="tnv">value</span>//<a class="tnb" href="https://reference.wolfram.com/language/ref/InputForm.html" rel="nofollow">InputForm</a>, <span class="ts">") +/- "</span>];
      <a class="tnb" href="https://reference.wolfram.com/language/ref/Print.html" rel="nofollow">Print</a>[<span class="ts">"       ("</span>, <span class="tnv">error</span>//<a class="tnb" href="https://reference.wolfram.com/language/ref/InputForm.html" rel="nofollow">InputForm</a>, <span class="ts">")"</span>]
      <a class="tnb" href="https://reference.wolfram.com/language/ref/Print.html" rel="nofollow">Print</a>[<span class="ts">"     )"</span>]
    )
  ]];
  <a class="tnb" href="https://reference.wolfram.com/language/ref/Print.html" rel="nofollow">Print</a>[<span class="ts">"  )"</span>];
  ,
  {<span class="tnv">prefactor</span>, <span class="tnv">symbolicPrefactors</span>}];
</pre>
  </body>
</html>
